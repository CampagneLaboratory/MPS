package ypath.traversalTests;

/*Generated by MPS */

import junit.framework.TestCase;
import org.w3c.dom.Document;
import jetbrains.mps.ypath.runtime.ITreeTraversal;
import org.w3c.dom.Node;
import jetbrains.mps.ypath.runtime.TreeTraversalFactory;
import junit.framework.Assert;
import java.io.InputStream;
import java.io.ByteArrayInputStream;
import javax.xml.parsers.DocumentBuilderFactory;
import jetbrains.mps.baseLanguage.ext.collections.internal.ICursor;
import jetbrains.mps.baseLanguage.ext.collections.internal.CursorFactory;

public class GenericFeatures_Test extends TestCase {
  public static String INPUT = "<root><a><foo/><bar><foo/></bar><baz><foo/></baz></a></root>";

  public void test_generic() throws Exception {
    Document doc = this.parse(GenericFeatures_Test.INPUT);
    ITreeTraversal<Node> foo = TreeTraversalFactory.Traverse(TreeTraversalFactory.Traverse(new DOMF().startTraversal(doc), TreeTraversalFactory.Axis("CHILDREN"), "elements"), TreeTraversalFactory.Axis("DESCENDANTS"), DOMF.child("foo"));
    Assert.assertEquals("foo, foo, foo", this.toString(foo));
  }

  public Document parse(String xml) throws Exception {
    InputStream is = new ByteArrayInputStream(xml.getBytes());
    Document doc = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(is);
    return doc;
  }

  public String toString(Iterable<Node> nodes) {
    StringBuilder sb = new StringBuilder();
    String sep = "";
    {
      ICursor<Node> _zCursor1 = CursorFactory.createCursor(nodes);
      try {
        while(_zCursor1.moveToNext()) {
          Node n = _zCursor1.getCurrent();
          sb.append(sep).append(n.getNodeName());
          sep = ", ";
        }
      } finally {
        _zCursor1.release();
      }
    }
    return sb.toString();
  }

}
