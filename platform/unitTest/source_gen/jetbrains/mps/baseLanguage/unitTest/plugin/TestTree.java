package jetbrains.mps.baseLanguage.unitTest.plugin;

/*Generated by MPS */

import jetbrains.mps.ide.ui.MPSTree;
import java.util.List;
import jetbrains.mps.smodel.SNode;
import jetbrains.mps.smodel.IOperationContext;
import java.util.ArrayList;
import jetbrains.mps.ide.ui.MPSTreeNode;
import jetbrains.mps.ide.ui.TextTreeNode;
import jetbrains.mps.baseLanguage.ext.collections.internal.ICursor;
import jetbrains.mps.baseLanguage.ext.collections.internal.CursorFactory;
import jetbrains.mps.bootstrap.smodelLanguage.generator.smodelAdapter.SLinkOperations;

public class TestTree extends MPSTree {

  private List<SNode> testCases;
  private IOperationContext operationContext;

  public  TestTree() {
    this.testCases = new ArrayList<SNode>();
  }

  public MPSTreeNode rebuild() {
    MPSTreeNode root = new TextTreeNode("Tests");
    {
      ICursor<SNode> _zCursor1 = CursorFactory.createCursor(this.testCases);
      try {
        while(_zCursor1.moveToNext()) {
          SNode testCase = _zCursor1.getCurrent();
          {
            TestCaseTreeNode testCaseTreeNode = new TestCaseTreeNode(this.operationContext, testCase);
            root.add(testCaseTreeNode);
            {
              ICursor<SNode> _zCursor2 = CursorFactory.createCursor(SLinkOperations.getTargets(SLinkOperations.getTarget(testCase, "testMethodList", true), "testMethod", true));
              try {
                while(_zCursor2.moveToNext()) {
                  SNode method = _zCursor2.getCurrent();
                  {
                    TestMethodTreeNode testMethodTreeNode = new TestMethodTreeNode(this.operationContext, method);
                    testCaseTreeNode.add(testMethodTreeNode);
                  }
                }
              } finally {
                _zCursor2.release();
              }
            }
          }
        }
      } finally {
        _zCursor1.release();
      }
    }
    return root;
  }

  public void setTestCases(IOperationContext operationContext, List<SNode> testCases) {
    this.operationContext = operationContext;
    this.testCases = testCases;
    this.rebuildNow();
  }

}
