package jetbrains.mps.graphLayout.graphLayout;

/*Generated by MPS */

import java.util.Map;
import jetbrains.mps.graphLayout.graph.INode;
import jetbrains.mps.graphLayout.intGeom2D.Rectangle;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import java.util.HashMap;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import jetbrains.mps.graphLayout.graph.IEdge;
import java.util.List;
import jetbrains.mps.graphLayout.intGeom2D.Point;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import jetbrains.mps.graphLayout.graph.Graph;

public class LayoutTransform {
  public static GraphLayout shift(GraphLayout layout, int xShift, int yShift) {
    GraphLayout newLayout = new GraphLayout((layout.getGraph()));
    Map<INode, Rectangle> nodeLayout = MapSequence.fromMap(new HashMap<INode, Rectangle>());
    for (INode node : SetSequence.fromSet(MapSequence.fromMap(nodeLayout).keySet())) {
      Rectangle rect = MapSequence.fromMap(nodeLayout).get(node);
      int newX = rect.x + xShift;
      int newY = rect.y + yShift;
      newLayout.setLayoutFor(node, new Rectangle(newX, newY, rect.width, rect.height));
    }
    Map<IEdge, List<Point>> edgeLayout = layout.getEdgeLayout();
    for (IEdge edge : SetSequence.fromSet(MapSequence.fromMap(edgeLayout).keySet())) {
      List<Point> newList = ListSequence.fromList(new ArrayList<Point>());
      for (Point p : ListSequence.fromList(MapSequence.fromMap(edgeLayout).get(edge))) {
        ListSequence.fromList(newList).addElement(new Point(p.x + xShift, p.y + yShift));
      }
      newLayout.setLayoutFor(edge, newList);
    }
    Map<IEdge, Rectangle> labelLayout = layout.getLabelLayout();
    for (IEdge edge : SetSequence.fromSet(MapSequence.fromMap(labelLayout).keySet())) {
      Rectangle rect = MapSequence.fromMap(labelLayout).get(edge);
      int newX = rect.x + xShift;
      int newY = rect.y + yShift;
      newLayout.setLabelLayout(edge, new Rectangle(newX, newY, rect.width, rect.height));
    }
    return newLayout;
  }

  public static GraphLayout scale(GraphLayout layout, double xScale, double yScale) {
    GraphLayout newLayout = new GraphLayout(((Graph) layout.getGraph()));
    Map<INode, Rectangle> nodeLayout = layout.getNodeLayout();
    for (INode node : SetSequence.fromSet(MapSequence.fromMap(nodeLayout).keySet())) {
      Rectangle rect = MapSequence.fromMap(nodeLayout).get(node);
      int newX = (int) (rect.x * xScale);
      int newY = (int) (rect.y * yScale);
      int newWidth = (int) (rect.width * xScale);
      int newHeight = (int) (rect.height * yScale);
      newLayout.setLayoutFor(node, new Rectangle(newX, newY, newWidth, newHeight));
    }
    Map<IEdge, List<Point>> edgeLayout = layout.getEdgeLayout();
    for (IEdge edge : SetSequence.fromSet(MapSequence.fromMap(edgeLayout).keySet())) {
      List<Point> newList = ListSequence.fromList(new ArrayList<Point>());
      for (Point p : ListSequence.fromList(MapSequence.fromMap(edgeLayout).get(edge))) {
        ListSequence.fromList(newList).addElement(new Point((int) (p.x * xScale), (int) (p.y * yScale)));
      }
      newLayout.setLayoutFor(edge, newList);
    }
    Map<IEdge, Rectangle> labelLayout = layout.getLabelLayout();
    for (IEdge edge : SetSequence.fromSet(MapSequence.fromMap(labelLayout).keySet())) {
      Rectangle rect = MapSequence.fromMap(labelLayout).get(edge);
      int newX = (int) (rect.x * xScale);
      int newY = (int) (rect.y * yScale);
      int newWidth = (int) (rect.width * xScale);
      int newHeight = (int) (rect.height * yScale);
      newLayout.setLabelLayout(edge, new Rectangle(newX, newY, newWidth, newHeight));
    }
    return newLayout;
  }
}
