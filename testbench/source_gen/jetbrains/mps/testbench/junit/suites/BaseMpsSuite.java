package jetbrains.mps.testbench.junit.suites;

/*Generated by MPS */

import org.junit.runners.Suite;
import org.junit.runners.model.RunnerBuilder;
import org.junit.runners.model.InitializationError;
import java.util.List;
import org.junit.runner.Runner;
import org.junit.runner.notification.RunNotifier;
import jetbrains.mps.RuntimeFlags;
import jetbrains.mps.TestMode;
import jetbrains.mps.tool.environment.Environment;
import jetbrains.mps.tool.environment.EnvironmentContainer;

public class BaseMpsSuite extends Suite {
  public BaseMpsSuite(Class<?> aClass, RunnerBuilder builder) throws InitializationError {
    super(aClass, builder);
  }

  public BaseMpsSuite(Class<?> klass, List<Runner> runners) throws InitializationError {
    super(klass, runners);
  }

  @Override
  public void run(RunNotifier notifier) {
    try {
      RuntimeFlags.setTestMode(TestMode.USUAL);
      super.run(notifier);
      Environment env = EnvironmentContainer.get();
      if (env != null) {
        env.dispose();
      }
    } catch (Throwable t) {
      t.printStackTrace(System.err);
      t.printStackTrace(System.out);
    } finally {
      RuntimeFlags.setTestMode(TestMode.NONE);
    }
  }
}
