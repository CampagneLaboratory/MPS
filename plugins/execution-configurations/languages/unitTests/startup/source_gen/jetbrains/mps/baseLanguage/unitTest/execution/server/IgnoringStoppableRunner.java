package jetbrains.mps.baseLanguage.unitTest.execution.server;

/*Generated by MPS */

import org.junit.runner.Request;
import org.junit.runner.notification.RunNotifier;
import org.junit.runner.notification.Failure;

public class IgnoringStoppableRunner extends StoppableRunner {
  private final Filter myIgnoringFilter;

  public IgnoringStoppableRunner(Request request, boolean stopping, Filter ignoringFilter) {
    super(request, stopping);
    myIgnoringFilter = ignoringFilter;
  }

  @Override
  protected void doRun(RunNotifier notifier) {
    if (myIgnoringFilter.accept(myRequest)) {
      myRequest.getRunner().run(notifier);
    } else {
      ignoreRequest(notifier);
    }
  }

  private void ignoreRequest(RunNotifier notifier) {
    notifier.fireTestStarted(getDescription());
    notifier.fireTestAssumptionFailed(new Failure(getDescription(), new Throwable("Ignoring test " + myRequest.getRunner().getDescription().getDisplayName())));
    notifier.fireTestFinished(getDescription());
  }
}
