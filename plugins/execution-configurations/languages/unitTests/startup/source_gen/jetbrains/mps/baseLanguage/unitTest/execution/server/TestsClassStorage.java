package jetbrains.mps.baseLanguage.unitTest.execution.server;

/*Generated by MPS */

import java.util.Map;
import java.util.HashMap;
import org.jetbrains.mps.openapi.module.SModule;
import jetbrains.mps.classloading.ClassLoaderManager;

public class TestsClassStorage {
  private final Map<String, Class> myLoadedClasses = new HashMap<String, Class>();

  private Class<?> tryLoadTestClass(String fqName, SModule module) throws ClassNotFoundException {
    final ClassLoader classLoader = ClassLoaderManager.getInstance().getClassLoader(module);
    assert classLoader != null;
    final Class<?> aClass = classLoader.loadClass(fqName);
    assert aClass != null;
    return aClass;
  }

  public Class<?> getTestClass(String fqName) throws ClassNotFoundException {
    if (!(myLoadedClasses.containsKey(fqName))) {
      throw new ClassNotFoundException();
    }
    return myLoadedClasses.get(fqName);
  }

  public Class<?> loadTestClass(String fqName, SModule module) throws ClassNotFoundException {
    final Class<?> aClass = tryLoadTestClass(fqName, module);
    myLoadedClasses.put(fqName, aClass);
    return aClass;
  }
}
