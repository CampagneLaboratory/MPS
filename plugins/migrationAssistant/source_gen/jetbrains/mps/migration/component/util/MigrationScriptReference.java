package jetbrains.mps.migration.component.util;

/*Generated by MPS */

import org.jetbrains.mps.openapi.module.SModuleReference;
import org.jetbrains.annotations.Nullable;
import org.jetbrains.mps.openapi.module.SRepository;

public class MigrationScriptReference {
  private final SModuleReference moduleReference;
  private final int fromVersion;

  public MigrationScriptReference(SModuleReference module, int fromVersion) {
    this.moduleReference = module;
    this.fromVersion = fromVersion;
  }

  public SModuleReference getModuleReference() {
    return moduleReference;
  }

  public int getFromVersion() {
    return fromVersion;
  }

  @Nullable
  public MigrationScript resolve(MigrationComponent migrationComponent, SRepository repository) {
    return check_dhbyxl_a0a5(migrationComponent.getMigrationDescriptor(moduleReference.resolve(repository)), fromVersion);
  }

  @Override
  public boolean equals(Object o) {
    if (this == o) {
      return true;
    }
    if (o == null || this.getClass() != o.getClass()) {
      return false;
    }
    MigrationScriptReference that = (MigrationScriptReference) o;
    if (!(moduleReference.equals(that.moduleReference))) {
      return false;
    }
    if (fromVersion != that.fromVersion) {
      return false;
    }
    return true;
  }

  @Override
  public int hashCode() {
    int result = 0;
    result = 31 * result + moduleReference.hashCode();
    result = 31 * result + fromVersion;
    return result;
  }

  private static MigrationScript check_dhbyxl_a0a5(MigrationDescriptor checkedDotOperand, int fromVersion) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.getScript(fromVersion);
    }
    return null;
  }
}
