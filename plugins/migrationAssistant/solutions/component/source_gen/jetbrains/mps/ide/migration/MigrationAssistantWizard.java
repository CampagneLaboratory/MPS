package jetbrains.mps.ide.migration;

/*Generated by MPS */

import com.intellij.ide.wizard.AbstractWizardEx;
import com.intellij.openapi.project.Project;
import java.util.Arrays;
import jetbrains.mps.ide.migration.wizard.InitialStep;
import jetbrains.mps.ide.migration.wizard.MigrationsProgressStep;
import jetbrains.mps.ide.migration.wizard.MigrationErrorStep_Pre;
import jetbrains.mps.ide.migration.wizard.MigrationErrorStep_Migration;
import jetbrains.mps.ide.migration.wizard.MigrationErrorStep_Post;
import java.awt.Dimension;
import jetbrains.mps.ide.migration.wizard.MigrationStep;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import javax.swing.SwingUtilities;

public class MigrationAssistantWizard extends AbstractWizardEx {
  public MigrationAssistantWizard(Project project, MigrationManager manager) {
    super("Migration Assistant Wizard", project, Arrays.asList(new InitialStep(project), new MigrationsProgressStep(project, manager), new MigrationErrorStep_Pre(project), new MigrationErrorStep_Migration(project), new MigrationErrorStep_Post(project)));
    Dimension oldSize = super.getPreferredSize();
    setSize(((int) oldSize.getWidth()), ((int) (oldSize.getHeight() + 90)));
  }

  @Override
  public boolean isAutoAdjustable() {
    return false;
  }
  @Override
  protected void updateStep() {
    super.updateStep();
    getCancelButton().setEnabled(((MigrationStep) getCurrentStepObject()).canBeCancelled());
  }
  @Override
  protected void doNextAction() {
    super.doNextAction();
    ((MigrationStep) getCurrentStepObject()).autostart(new _FunctionTypes._void_P0_E0() {
      public void invoke() {
        SwingUtilities.invokeLater(new Runnable() {
          public void run() {
            updateStep();
          }
        });
      }
    });
  }
  public boolean isFinishSuccessfull() {
    return ((MigrationsProgressStep) mySteps.get(1)).isEverythingOk();
  }
}
