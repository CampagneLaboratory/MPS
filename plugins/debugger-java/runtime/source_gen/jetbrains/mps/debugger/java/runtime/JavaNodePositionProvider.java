package jetbrains.mps.debugger.java.runtime;

/*Generated by MPS */

import jetbrains.mps.debug.api.source.NodePositionProvider;
import com.intellij.openapi.components.ProjectComponent;
import jetbrains.mps.debug.api.source.PositionProvider;
import org.jetbrains.annotations.Nullable;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.annotations.NonNls;
import jetbrains.mps.generator.traceInfo.TraceInfoUtil;
import jetbrains.mps.debug.api.source.NodeSourcePosition;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.debug.api.AbstractDebugSession;
import jetbrains.mps.debugger.java.runtime.state.DebugSession;

public class JavaNodePositionProvider extends NodePositionProvider implements ProjectComponent {
  private final PositionProvider myProvider;

  public JavaNodePositionProvider(PositionProvider provider) {
    myProvider = provider;
  }

  @Nullable
  @Override
  public SNode getNode(@NonNls String unitName, @NonNls String fileName, int position) {
    return TraceInfoUtil.getJavaNode(unitName, fileName, position);
  }

  public void projectOpened() {
  }

  public void projectClosed() {
  }

  public void initComponent() {
    myProvider.addProvider(this, NodeSourcePosition.class.getName());
  }

  public void disposeComponent() {
    myProvider.removeProvider(this);
  }

  @NonNls
  @NotNull
  public String getComponentName() {
    return "Java Node Position Provider";
  }

  @Override
  public boolean accepts(AbstractDebugSession session) {
    return session instanceof DebugSession;
  }
}
