package jetbrains.mps.debugger.java.runtime.execution;

/*Generated by MPS */


public abstract class DebuggerCommand implements IDebuggerCommand {
  private boolean myOnHold = false;

  public DebuggerCommand() {
  }

  @Override
  public final void release() {
    if (myOnHold) {
      myOnHold = false;
      notifyAll();
    }
  }

  @Override
  public final void hold() {
    myOnHold = true;
  }

  @Override
  public final void waitFor() {
    while (myOnHold) {
      try {
        wait();
      } catch (InterruptedException ignored) {
      }
    }
  }

  public IDebuggerCommand.CommandPriority getPriority() {
    return IDebuggerCommand.CommandPriority.LOW;
  }

  public final void notifyCancelled() {
    try {
      commandCancelled();
    } finally {
      release();
    }
  }

  public final void run() throws Exception {
    try {
      action();
    } finally {
      release();
    }
  }

  protected abstract void action() throws Exception;

  protected void commandCancelled() {
  }
}
