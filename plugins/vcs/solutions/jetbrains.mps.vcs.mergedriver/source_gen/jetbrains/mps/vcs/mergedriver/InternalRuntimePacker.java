package jetbrains.mps.vcs.mergedriver;

/*Generated by MPS */

import com.intellij.openapi.application.PathManager;
import java.io.File;
import jetbrains.mps.util.FileUtil;
import jetbrains.mps.internal.collections.runtime.SetSequence;

public class InternalRuntimePacker {
  private static final String MERGER_RT = "merger-rt.jar";

  private InternalRuntimePacker() {
  }

  public static String getPath() {
    return PathManager.getConfigPath() + File.separator + MERGER_RT;
  }

  public static File getFile() {
    return new File(getPath());
  }

  public static void pack() {
    File tmpDir = FileUtil.createTmpDir();
    getFile().delete();
    for (String cpi : SetSequence.fromSet(CommandLineGenerator.getClasspath(false))) {
      if (!(cpi.endsWith(".jar"))) {
        FileUtil.copyDir(new File(cpi), tmpDir);
      }
    }
    FileUtil.zip(tmpDir, getFile());
    tmpDir.delete();
  }
}
