package jetbrains.mps.ide.make.actions;

/*Generated by MPS */

import java.util.Map;
import jetbrains.mps.project.MPSProject;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import java.util.HashMap;
import com.intellij.openapi.wm.StatusBar;
import com.intellij.openapi.project.Project;
import com.intellij.openapi.project.ProjectManager;
import jetbrains.mps.ide.project.ProjectHelper;

public class TransientModelsWidgetInstaller {
  private static final Map<MPSProject, TransientModelsWidgetInstaller> ourInstances = MapSequence.fromMap(new HashMap<MPSProject, TransientModelsWidgetInstaller>());

  private StatusBar myStatusBar;
  private TransientModelsWidget myWidget;
  private final MPSProject myProject;

  public TransientModelsWidgetInstaller(MPSProject project) {
    myProject = project;
    MapSequence.fromMap(ourInstances).put(myProject, this);
  }

  public void init(StatusBar bar) {
    myStatusBar = bar;
    myWidget = new TransientModelsWidget(bar);
    myStatusBar.addWidget(myWidget);
    myWidget.update();
  }

  public void dispose() {
    myStatusBar.removeWidget(myWidget.ID());
    MapSequence.fromMap(ourInstances).removeKey(myProject);
  }

  public TransientModelsWidget getWidget() {
    return myWidget;
  }

  public static void updateWidgets() {
    for (Project project : ProjectManager.getInstance().getOpenProjects()) {
      check_ma0d6w_a0a0a0a(MapSequence.fromMap(ourInstances).get(ProjectHelper.toMPSProject(project))).update();
    }
  }

  private static TransientModelsWidget check_ma0d6w_a0a0a0a(TransientModelsWidgetInstaller checkedDotOperand) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.myWidget;
    }
    return null;
  }
}
