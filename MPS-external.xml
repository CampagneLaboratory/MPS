<?xml version="1.0" encoding="UTF-8"?>
<project name="MPS-external" default="main">
  <import file="MPS-languages.xml" />
  <import file="MPS-multystep.xml" />
  <import file="build-helpers.xml" />
  <property file=".\MPS.properties" />
  <target name="main" depends="clean.before,folders.create,do.the.job,clean.after" />
  <target name="clean.before">
    <delete dir="${deploy.dir}" />
    <tstamp />
  </target>
  <target name="folders.create" depends="clean.before">
    <mkdir dir="${deploy.dir}" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/Contents" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/bin" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/beansbinding" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/annotations" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/ant-1.7.0" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/asm" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/alloy" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-lang" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-logging" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/eclipse-compiler" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/httpclient" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/htmlparser" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/idea-rt" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/jdom" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/idea-platform" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/joda-time" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/junit" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/junit4" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/log4j" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/spring" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/stax" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/xstream" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/quartz" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-codecs" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-email" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-io" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-fileupload" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/freemarker" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/httpunit" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/jetty" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mime-util" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/servlet-api" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/smack" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp/idea" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/agreement" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/complexLanguage" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/dslbook_example" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/fixedLengthReader" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/formulaLanguage" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/jetbrains.mps.matrixLanguage" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/core" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/core/baseLanguage" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/core/languageDesign" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/platform" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/docs" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/plugin" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/workbench" />
    <mkdir dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/log" />
  </target>
  <target name="do.the.job" depends="folders.create">
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/Contents">
      <fileset dir="build/Contents" excludes="**/*.iml, **/*.ipr" includes="" />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/bin">
      <fileset dir="bin" excludes="**/*.iml, **/*.ipr" includes="" />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/beansbinding">
      <fileset dir="lib/beansbinding" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/annotations">
      <fileset dir="lib/annotations" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/ant-1.7.0">
      <fileset dir="lib/ant-1.7.0" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/asm">
      <fileset dir="lib/asm" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/alloy">
      <fileset dir="lib/alloy" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-lang">
      <fileset dir="lib/commons-lang" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-logging">
      <fileset dir="lib/commons-logging" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/eclipse-compiler">
      <fileset dir="lib/eclipse-compiler" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/httpclient">
      <fileset dir="lib/httpclient" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/htmlparser">
      <fileset dir="lib/htmlparser" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/idea-rt">
      <fileset dir="lib/idea-rt" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/jdom">
      <fileset dir="lib/jdom" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/idea-platform">
      <fileset dir="lib/idea-platform" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/joda-time">
      <fileset dir="lib/joda-time" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/junit">
      <fileset dir="lib/junit" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/junit4">
      <fileset dir="lib/junit4" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/log4j">
      <fileset dir="lib/log4j" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/spring">
      <fileset dir="lib/spring" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/stax">
      <fileset dir="lib/stax" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/xstream">
      <fileset dir="lib/xstream" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/quartz">
      <fileset dir="lib/quartz" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-codecs">
      <fileset dir="lib/commons-codecs" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-email">
      <fileset dir="lib/commons-email" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-io">
      <fileset dir="lib/commons-io" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/commons-fileupload">
      <fileset dir="lib/commons-fileupload" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/freemarker">
      <fileset dir="lib/freemarker" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/httpunit">
      <fileset dir="lib/httpunit" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/jetty">
      <fileset dir="lib/jetty" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mime-util">
      <fileset dir="lib/mime-util" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/servlet-api">
      <fileset dir="lib/servlet-api" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/smack">
      <fileset dir="lib/smack" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="classes" excludes="production/, test/, **/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="workbench/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/kernel/classes" excludes="idea/MPSApplicationInfo.xml, **/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <antcall target="replace" />
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/core/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/actionsLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/editorLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/annotations/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/constraintsLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/editorLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/findUsagesLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/helgins/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/intentionsLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/patternLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/pluginLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/quotation/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/refactoring/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/scriptLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/sharedConcepts/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/smodelLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/structureLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/transformation/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/dataFlow/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/dataFlow/runtime/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/projectLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/baseLanguage/baseLanguage/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/baseLanguage/collections/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/baseLanguage/collections/runtime/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/baseLanguage/closures/runtime/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/baseLanguage/closures/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/baseLanguage/internalCollections/languages/collections/runtime/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/baseLanguage/internalCollections/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/baseLanguage/classifiers/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/runtime/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/languageDesign/transformationTest/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="core/idea-patch/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="platform/uiLanguage/runtime/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp">
      <fileset dir="MPSPlugin/MPSSupport/classes" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </copy>
    <jar destfile="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar" duplicate="preserve" filesonly="true">
      <fileset dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp" excludes="**/*.java, **/*.zip, **/*.iml, **/*.ipr" includes="**/*.jar, **/*.class, **/*.png, **/*.xml, " />
    </jar>
    <delete dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp" />
    <antcall target="zkm" inheritall="true">
      <param name="deploy.dir" value="${deploy.dir}" />
      <param name="input.dir" value="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm" />
      <param name="output.dir" value="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib" />
    </antcall>
    <delete dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm" />
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/agreement">
      <fileset dir="app/agreement" excludes="**/*.iml, **/*.ipr" includes="" />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/complexLanguage">
      <fileset dir="app/complexLanguage" excludes="**/*.iml, **/*.ipr" includes="" />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/dslbook_example">
      <fileset dir="app/dslbook_example" excludes="**/*.iml, **/*.ipr" includes="" />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/fixedLengthReader">
      <fileset dir="app/fixedLengthReader" excludes="**/*.iml, **/*.ipr" includes="" />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/formulaLanguage">
      <fileset dir="app/formulaLanguage" excludes="**/*.iml, **/*.ipr" includes="" />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/app/jetbrains.mps.matrixLanguage">
      <fileset dir="app/jetbrains.mps.matrixLanguage" excludes="**/*.iml, **/*.ipr" includes="" />
    </copy>
    <antcall target="pack.jetbrains.mps.baseLanguageInternal" />
    <antcall target="pack.jetbrains.mps.closures" />
    <antcall target="pack.jetbrains.mps.baseLanguage.ext.collections.lang" />
    <antcall target="pack.collections_samples" />
    <antcall target="pack.jetbrains.mps.baseLanguage.ext.csharp" />
    <antcall target="pack.jetbrains.mps.baseLanguage.ext.dates.lang" />
    <antcall target="pack.jetbrains.mps.baseLanguage.ext.dates.internal" />
    <antcall target="pack.jetbrains.mps.baseLanguage.dates.runtime" />
    <antcall target="pack.jetbrains.mps.internal.collections" />
    <antcall target="pack.jetbrains.accounting.money" />
    <antcall target="pack.JDK" />
    <antcall target="pack.jetbrains.mps.baseLanguage.blTypes" />
    <antcall target="pack.jetbrains.mps.baseLanguage" />
    <antcall target="pack.jetbrains.mps.baseLanguage.strings" />
    <antcall target="pack.MPS.Classpath" />
    <antcall target="pack.refactoring" />
    <antcall target="pack.jetbrains.mps.baseLanguage.classifiers" />
    <antcall target="pack.jetbrains.mps.bootstrap.actionsLanguage" />
    <antcall target="pack.jetbrains.mps.annotations" />
    <antcall target="pack.jetbrains.mps.bootstrap.constraintsLanguage" />
    <antcall target="pack.jetbrains.mps.bootstrap.editorLanguage" />
    <antcall target="pack.jetbrains.mps.bootstrap.findUsagesLanguage" />
    <antcall target="pack.jetbrains.mps.bootstrap.helgins" />
    <antcall target="pack.jetbrains.mps.bootstrap.intentionsLanguage" />
    <antcall target="pack.jetbrains.mps.bootstrap.dataFlow" />
    <antcall target="pack.jetbrains.mpslite" />
    <antcall target="pack.jetbrains.mps.nanoj" />
    <antcall target="pack.jetbrains.mps.patterns" />
    <antcall target="pack.jetbrains.mps.quotation" />
    <antcall target="pack.jetbrains.mps.bootstrap.pluginLanguage" />
    <antcall target="pack.jetbrains.mps.bootstrap.sharedConcepts" />
    <antcall target="pack.jetbrains.mps.bootstrap.smodelLanguage" />
    <antcall target="pack.jetbrains.mps.ide.scriptLanguage" />
    <antcall target="pack.jetbrains.mps.ide.scriptLanguageInternal" />
    <antcall target="pack.jetbrains.mps.bootstrap.structureLanguage" />
    <antcall target="pack.jetbrains.mps.core" />
    <antcall target="pack.jetbrains.mps.logging.refactoring" />
    <antcall target="pack.jetbrains.mps.transformation.TLBase" />
    <antcall target="pack.jetbrains.mps.transformationTest" />
    <antcall target="pack.jetbrains.mps.transformationTest.runtime" />
    <antcall target="pack.jetbrains.mps.projectLanguage" />
    <antcall target="pack.transform" />
    <antcall target="pack.ypath.main" />
    <antcall target="pack.ypath.test" />
    <antcall target="pack.jetbrains.mps.ypath" />
    <antcall target="pack.jetbrains.mps.buildlanguage" />
    <antcall target="pack.jetbrains.mps.mpsLayoutLanguage" />
    <antcall target="pack.jetbrains.mps.mpsProjectLanguage" />
    <antcall target="pack.jetbrains.mps.propertylanguage" />
    <antcall target="pack.jetbrains.mps.bookLanguage" />
    <antcall target="pack.jetbrains.mps.regexp" />
    <antcall target="pack.jetbrains.mps.regexp.examples" />
    <antcall target="pack.jetbrains.mps.textLanguage" />
    <antcall target="pack.jetbrains.mps.textLanguage.formula" />
    <antcall target="pack.jetbrains.mps.textLanguage.table" />
    <antcall target="pack.jetbrains.mps.uiLanguage" />
    <antcall target="pack.jetbrains.mps.baseLanguage.unitTest" />
    <antcall target="pack.jetbrains.mps.baseLanguage.unitTest.runtime" />
    <antcall target="pack.jetbrains.mps.xml" />
    <antcall target="pack.jetbrains.springframework.configuration" />
    <antcall target="pack.jetbrains.springframework.configurationInternal" />
    <antcall target="pack.jetbrains.mps.springframework.configuration.runtime" />
    <antcall target="pack.webr.logging" />
    <antcall target="pack.webr.xml" />
    <antcall target="pack.webr.gtext" />
    <antcall target="pack.webr.xmlInternal" />
    <antcall target="pack.webr.xmlSchema" />
    <antcall target="pack.jetbrains.mps.gtext.runtime" />
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/docs">
      <fileset dir="docs" excludes="**/*.java, **/*.iml, **/*.ipr" includes="" />
    </copy>
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/plugin">
      <fileset dir="plugin" excludes="**/*.java, **/*.iml, **/*.ipr" includes="" />
    </copy>
    <antcall target="pack.jetbrains.mps.ide.uiLanguage" />
    <antcall target="pack.jetbrains.mps.monitorLanguage" />
    <antcall target="pack.jetbrains.mps.ide" />
    <copy todir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/log">
      <fileset dir="log" excludes="**/*.java, **/*.iml, **/*.ipr" includes="" />
    </copy>
    <echo file="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/build.number">build.number=${build.number}${line.separator}date=${DSTAMP}${line.separator}revision.number=${build.vcs.number}${line.separator}configuration.name=${teamcity.buildConfName}</echo>
    <copy file="entryPoints.xml" tofile="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/entryPoints.xml" />
    <copy file="readme.txt" tofile="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/readme.txt" />
    <copy file="mps.sh" tofile="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/mps.sh" />
    <copy file="mps.bat" tofile="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/mps.bat" />
    <zip destfile="${deploy.dir}/MPS-${build.number}.zip" duplicate="preserve" filesonly="true">
      <zipfileset dir="${deploy.dir}/MPS-${build.number}.zip.tmp" excludes="**/*.iml, **/*.ipr" includes="" filemode="755" />
    </zip>
    <delete dir="${deploy.dir}/MPS-${build.number}.zip.tmp" />
  </target>
  <target name="clean.after" depends="do.the.job">
    <delete dir="${deploy.dir}/MPS-${build.number}.zip.tmp" />
    <delete dir="${deploy.dir}/MPS-${build.number}.zip.tmp/MPS/lib/build-helpers.zkm/mps.jar.tmp" />
  </target>
</project>

