<project name="MPS-os-specific-default" default="main">
  <property file="${ant.file.MPS-os-specific-default}/../MPS-os-specific.properties" />
  <import file="${ant.file.MPS-os-specific-default}/../MPS-os-specific.xml" />
  <target name="main" depends="compile,clean.before,folders.create,do.the.job,clean.after" />
  <target name="compile" />
  <target name="clean">
    <property name="to.clean" value="${deploy.dir}" />
    <echo>Removing directory ${to.clean}</echo>
    <delete dir="${to.clean}" />
  </target>
  <target name="clean.before" depends="compile">
    <tstamp />
  </target>
  <target name="folders.create" depends="clean.before">
    <mkdir dir="${deploy.dir}" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.tar/MPS" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.tar/bin" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.tar/help" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.tar" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.zip/MPS" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.zip/bin" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.zip/help" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.zip" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.mac/MPS" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.mac/bin" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.mac/help" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.mac" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.exe/MPS/bin" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.exe/MPS" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.exe/help" />
    <mkdir dir="${deploy.dir}/MPS-os-specific.exe" />
  </target>
  <target name="do.the.job" depends="folders.create">
    <copy todir="${deploy.dir}/MPS-os-specific.tar/MPS">
      <fileset dir="${base_dir}/../MPS.artifacts/MPS" />
    </copy>
    <copy todir="${deploy.dir}/MPS-os-specific.tar/bin">
      <fileset dir="${base_dir}/bin" />
    </copy>
    <copy file="${base_dir}/build/mps.vmoptions" tofile="${deploy.dir}/MPS-os-specific.tar/mps.vmoptions" />
    <copy file="${base_dir}/build/mps.sh" tofile="${deploy.dir}/MPS-os-specific.tar/mps.sh" />
    <copy todir="${deploy.dir}/MPS-os-specific.tar/help">
      <fileset dir="${base_dir}/help" />
    </copy>
    <antcall target="MPS-os-specific.tar" inheritall="true">
      <param name="deploy.dir" value="${deploy.dir}" />
      <param name="input.dir" value="${deploy.dir}/MPS-os-specific.tar" />
      <param name="output.dir" value="${deploy.dir}/" />
      <param name="base_dir" value="${base_dir}" />
    </antcall>
    <delete dir="${deploy.dir}/MPS-os-specific.tar" />
    <copy todir="${deploy.dir}/MPS-os-specific.zip/MPS">
      <fileset dir="${base_dir}/../MPS.artifacts/MPS" />
    </copy>
    <copy todir="${deploy.dir}/MPS-os-specific.zip/bin">
      <fileset dir="${base_dir}/bin" />
    </copy>
    <copy file="${base_dir}/build/mps.vmoptions" tofile="${deploy.dir}/MPS-os-specific.zip/mps.vmoptions" />
    <copy file="${base_dir}/build/mps.vmoptions" tofile="${deploy.dir}/MPS-os-specific.zip/mps.exe.vmoptions" />
    <copy file="${base_dir}/build/mps.sh" tofile="${deploy.dir}/MPS-os-specific.zip/mps.sh" />
    <copy file="${base_dir}/build/mps.bat" tofile="${deploy.dir}/MPS-os-specific.zip/mps.bat" />
    <copy todir="${deploy.dir}/MPS-os-specific.zip/help">
      <fileset dir="${base_dir}/help" />
    </copy>
    <antcall target="MPS-os-specific.zip" inheritall="true">
      <param name="deploy.dir" value="${deploy.dir}" />
      <param name="input.dir" value="${deploy.dir}/MPS-os-specific.zip" />
      <param name="output.dir" value="${deploy.dir}/" />
      <param name="base_dir" value="${base_dir}" />
    </antcall>
    <delete dir="${deploy.dir}/MPS-os-specific.zip" />
    <copy todir="${deploy.dir}/MPS-os-specific.mac/MPS">
      <fileset dir="${base_dir}/../MPS.artifacts/MPS" />
    </copy>
    <copy todir="${deploy.dir}/MPS-os-specific.mac/bin">
      <fileset dir="${base_dir}/bin" />
    </copy>
    <copy file="${base_dir}/build/mps.vmoptions" tofile="${deploy.dir}/MPS-os-specific.mac/mps.vmoptions" />
    <copy file="${base_dir}/build/mps.sh" tofile="${deploy.dir}/MPS-os-specific.mac/mps.sh" />
    <copy todir="${deploy.dir}/MPS-os-specific.mac/help">
      <fileset dir="${base_dir}/help" />
    </copy>
    <copy file="${base_dir}/build/Info.plist" tofile="${deploy.dir}/MPS-os-specific.mac/Info.plist" />
    <copy file="${base_dir}/build/resources/mps.icns" tofile="${deploy.dir}/MPS-os-specific.mac/mps.icns" />
    <copy file="${base_dir}/build/resources/mps" tofile="${deploy.dir}/MPS-os-specific.mac/mps.executable" />
    <antcall target="MPS-os-specific.mac" inheritall="true">
      <param name="deploy.dir" value="${deploy.dir}" />
      <param name="input.dir" value="${deploy.dir}/MPS-os-specific.mac" />
      <param name="output.dir" value="${deploy.dir}/" />
      <param name="base_dir" value="${base_dir}" />
    </antcall>
    <delete dir="${deploy.dir}/MPS-os-specific.mac" />
    <copy todir="${deploy.dir}/MPS-os-specific.exe/MPS/bin">
      <fileset dir="${base_dir}/bin/win" excludes="**/bin/linux/**, **/bin/mac/**, **/bin/nix/**, **/bin/win/**, " />
    </copy>
    <copy todir="${deploy.dir}/MPS-os-specific.exe/MPS">
      <fileset dir="${base_dir}/../MPS.artifacts/MPS" excludes="**/bin/linux/**, **/bin/mac/**, **/bin/nix/**, **/bin/win/**, " />
    </copy>
    <copy file="${base_dir}/build/mps.vmoptions" tofile="${deploy.dir}/MPS-os-specific.exe/mps.exe.vmoptions" />
    <copy file="${base_dir}/build/mps.bat" tofile="${deploy.dir}/MPS-os-specific.exe/mps.bat" />
    <copy todir="${deploy.dir}/MPS-os-specific.exe/help">
      <fileset dir="${base_dir}/help" />
    </copy>
    <copy file="${base_dir}/build/resources/mps.ico" tofile="${deploy.dir}/MPS-os-specific.exe/mps.ico" />
    <copy file="${base_dir}/build/resources/mps.inst.ico" tofile="${deploy.dir}/MPS-os-specific.exe/installer.ico" />
    <copy file="${base_dir}/build/resources/mps.uninst.ico" tofile="${deploy.dir}/MPS-os-specific.exe/uninstaller.ico" />
    <copy file="${base_dir}/build/resources/homepage.ico" tofile="${deploy.dir}/MPS-os-specific.exe/homepage.ico" />
    <copy file="${base_dir}/build/tools/jre.zip" tofile="${deploy.dir}/MPS-os-specific.exe/jre.zip" />
    <copy file="${base_dir}/build/tools/nsis.zip" tofile="${deploy.dir}/MPS-os-specific.exe/nsis.zip" />
    <copy file="${base_dir}/build/installer.nsi" tofile="${deploy.dir}/MPS-os-specific.exe/installer.nsi" />
    <copy file="${base_dir}/license/mps_license.txt" tofile="${deploy.dir}/MPS-os-specific.exe/license.txt" />
    <antcall target="MPS-os-specific.exe" inheritall="true">
      <param name="deploy.dir" value="${deploy.dir}" />
      <param name="input.dir" value="${deploy.dir}/MPS-os-specific.exe" />
      <param name="output.dir" value="${deploy.dir}/" />
      <param name="base_dir" value="${base_dir}" />
    </antcall>
    <delete dir="${deploy.dir}/MPS-os-specific.exe" />
  </target>
  <target name="clean.after" depends="do.the.job">
    <delete dir="${deploy.dir}/MPS/lib/MPS-src.zip.tmp" />
    <delete dir="${deploy.dir}/MPS/samples.zip.tmp" />
    <delete dir="${deploy.dir}/${build.number}-buildTools.zip.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-resources.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-resources_en.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-core.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-editor-api.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-editor.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-platform.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-workbench.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-boot.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-test.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-collections.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-closures.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-tuples.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/lib/mps-backend.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/ideaIntegration.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/vcs/lib/vcs.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/vcs/lib/mps-vcs-core.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/mpsdevkit/lib/mpsdevkit.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/mpsmake.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/migrationAssistant.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/mpsjava.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/modelchecker.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/samples.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/debugger-java/lib/debugger-java.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/debugger-java-customViewers.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/debugger-api-languages/lib/debugger-api-languages.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/execution-configurations/lib/execution-configurations.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/plugins/execution-languages/lib/execution-languages.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/languages/baseLanguage/jetbrains.mps.baseLanguage.collections.runtime.gwt-src.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/languages/baseLanguage/jetbrains.mps.baseLanguage.collections.runtime-src.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/languages/baseLanguage/jetbrains.mps.baseLanguage.closures.runtime-src.jar.tmp" />
    <delete dir="${deploy.dir}/MPS/languages/baseLanguage/jetbrains.mps.baseLanguage.tuples.runtime-src.jar.tmp" />
  </target>
</project>
