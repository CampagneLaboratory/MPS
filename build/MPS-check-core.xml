<project name="MPS-compile" default="compile" basedir="..">

  <path id="core.sources">
    <path path="core/kernel/source"/>
    <path path="core/kernel/source_gen"/>
    <path path="core/generator/source" />
    <path path="core/runtime/source" />
    <path path="core/kernel/traceinfo/solutions/jetbrains.mps.debug.api.info/source_gen" />

    <dirset dir="core/languageDesign">
      <include name="**/source/**/structure"/>
      <include name="**/source_gen/**/structure"/>
      <include name="**/source/**/behavior"/>
      <include name="**/source_gen/**/behavior"/>
      <include name="**/source_gen/**/generator*/"/>
      <include name="refactoring/source"/>
      <include name="typesystem/source"/>
      <include name="pattern/source"/>

      <exclude name="**/bootstrap.helgins.test/**"/>
      <exclude name="**/pattern/testLang/**"/>
    </dirset>

    <dirset dir="core/baseLanguage">                    
      <include name="**/source/**/structure"/>
      <include name="**/source_gen/**/structure"/>
      <include name="**/source/**/behavior"/>
      <include name="**/source_gen/**/behavior"/>
      <include name="**/source_gen/**/generator*/"/>
      <include name="collections/runtime/source_gen"/>
      <include name="baseLanguage/source_gen/**/textGen"/>
    </dirset>
  </path>

  <path id="core.classpath">
    <fileset dir="lib" includes="*.jar"/>
    <path path="lib/commons-lang/commons-lang-2.1.jar" />
    <path path="lib/eclipse-compiler/ecj.jar" />
    <path path="lib/jdom/jdom.jar" />
    <path path="lib/junit4/junit-4.8.2.jar" />
    <path path="lib/log4j/log4j.jar" />
    <path path="lib/asm/asm.jar" />
  </path>

  <target name="clean">
    <delete dir="tempbuild"/>
  </target>

  <target name="compile" depends="clean">
    <mkdir dir="tempbuild"/>

<!--
    <property name="myclasspath" refid="core.sources"/>
    <echo message="Classpath = ${myclasspath}"/>
    -->


    <javac classpathref="core.classpath" destdir="tempbuild" fork="true" memorymaximumsize="1024m">
      <src refid="core.sources" />
    </javac>
  </target>

</project>