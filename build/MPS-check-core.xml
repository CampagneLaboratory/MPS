<!--
  ~ Copyright 2003-2010 JetBrains s.r.o.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<project name="MPS-compile" default="compile" basedir="..">

  <path id="core.sources">
    <!-- hack -->
    <path path="build/tempsource"/>

    <!-- core -->
    <path path="core/kernel/source"/>
    <path path="core/kernel/source_gen"/>
    <path path="core/generator/source" />
    <path path="core/runtime/source" />
    <path path="core/kernel/traceinfo/solutions/jetbrains.mps.debug.api.info/source_gen" />
    <path path="core/kernel/xmlQuery/runtime/source_gen"/>

    <!-- typesystem engine -->
    <path path="core/typesystemEngine/source/jetbrains/mps/lang"/>
    <path path="core/typesystemEngine/source/jetbrains/mps/typesystem/debug"/>
    <path path="core/typesystemEngine/source/jetbrains/mps/typesystem/inference"/>
    <path path="core/typesystemEngine/source/jetbrains/mps/typesystem/newTypesystem"/>
    <path path="core/typesystemEngine/source/jetbrains/mps/typesystem/integration"/>

    <!-- actions -->
    <path path="core/languageDesign/actions/source_gen/jetbrains/mps/lang/actions/structure"/>

    <!-- annotations -->
    <path path="core/languageDesign/annotations/source_gen/jetbrains/mps/lang/annotations/structure"/>

    <!-- behavior -->
    <path path="core/languageDesign/behavior/source_gen/jetbrains/mps/lang/behavior/behavior"/>
    <path path="core/languageDesign/behavior/source_gen/jetbrains/mps/lang/behavior/generator"/>
    <path path="core/languageDesign/behavior/source_gen/jetbrains/mps/lang/behavior/structure"/>
    <path path="core/languageDesign/behavior/source_gen/jetbrains/mps/lang/behavior/typesystem"/>

    <!-- constraints -->
    <path path="core/languageDesign/constraints/source_gen/jetbrains/mps/lang/constraints/behavior"/>
    <path path="core/languageDesign/constraints/source_gen/jetbrains/mps/lang/constraints/generator"/>
    <path path="core/languageDesign/constraints/source_gen/jetbrains/mps/lang/constraints/structure"/>
    <path path="core/languageDesign/constraints/source_gen/jetbrains/mps/lang/constraints/typesystem"/>

    <!-- core -->
    <path path="core/languageDesign/core/source_gen/jetbrains/mps/lang/core/behavior"/>
    <path path="core/languageDesign/core/source_gen/jetbrains/mps/lang/core/structure"/>

    <!-- dataFlow -->
    <path path="core/languageDesign/dataFlow/source_gen/jetbrains/mps/lang/dataFlow/behavior"/>
    <path path="core/languageDesign/dataFlow/source_gen/jetbrains/mps/lang/dataFlow/structure"/>

    <!-- editor -->
    <path path="core/languageDesign/editor/source_gen/jetbrains/mps/lang/editor/structure"/>

    <!-- findUsages -->
    <path path="core/languageDesign/findUsages/source_gen/jetbrains/mps/lang/findUsages/structure"/>

    <!-- generator -->
    <path path="core/languageDesign/generator/source_gen/jetbrains/mps/lang/generator/generationContext/behavior"/>
    <path path="core/languageDesign/generator/source_gen/jetbrains/mps/lang/generator/generationContext/generator"/>
    <path path="core/languageDesign/generator/source_gen/jetbrains/mps/lang/generator/generationContext/structure"/>
    <path path="core/languageDesign/generator/source_gen/jetbrains/mps/lang/generator/generationContext/typesystem"/>
    <path path="core/languageDesign/generator/source_gen/jetbrains/mps/lang/generator/behavior"/>
    <path path="core/languageDesign/generator/source_gen/jetbrains/mps/lang/generator/generator"/>
    <path path="core/languageDesign/generator/source_gen/jetbrains/mps/lang/generator/structure"/>
    <path path="core/languageDesign/generator/source_gen/jetbrains/mps/lang/generator/typesystem"/>
    <path path="core/languageDesign/generator/source/jetbrains/mps/lang/generator/generator"/>

    <!-- intentions -->
    <path path="core/languageDesign/intentions/source_gen/jetbrains/mps/lang/intentions/structure"/>

    <!-- pattern -->
    <path path="core/languageDesign/pattern/source"/>
    <path path="core/languageDesign/pattern/source_gen/jetbrains/mps/lang/pattern/behavior"/>
    <path path="core/languageDesign/pattern/source_gen/jetbrains/mps/lang/pattern/generator"/>
    <path path="core/languageDesign/pattern/source_gen/jetbrains/mps/lang/pattern/structure"/>
    <path path="core/languageDesign/pattern/source_gen/jetbrains/mps/lang/pattern/typesystem"/>

    <!-- plugin -->
    <path path="core/languageDesign/plugin/source_gen/jetbrains/mps/lang/plugin/behavior"/>
    <path path="core/languageDesign/plugin/source_gen/jetbrains/mps/lang/plugin/generator"/>
    <path path="core/languageDesign/plugin/source_gen/jetbrains/mps/lang/plugin/structure"/>
    <path path="core/languageDesign/plugin/source_gen/jetbrains/mps/lang/plugin/typesystem"/>

    <!-- quotation -->
    <path path="core/languageDesign/quotation/source_gen/jetbrains/mps/lang/quotation/behavior"/>
    <path path="core/languageDesign/quotation/source_gen/jetbrains/mps/lang/quotation/generator"/>
    <path path="core/languageDesign/quotation/source_gen/jetbrains/mps/lang/quotation/structure"/>
    <path path="core/languageDesign/quotation/source_gen/jetbrains/mps/lang/quotation/typesystem"/>

    <!-- refactoring -->
    <path path="core/languageDesign/refactoring/source"/>
    <path path="core/languageDesign/refactoring/source_gen/jetbrains/mps/lang/refactoring/behavior"/>
    <path path="core/languageDesign/refactoring/source_gen/jetbrains/mps/lang/refactoring/generator"/>
    <path path="core/languageDesign/refactoring/source_gen/jetbrains/mps/lang/refactoring/structure"/>
    <path path="core/languageDesign/refactoring/source_gen/jetbrains/mps/lang/refactoring/typesystem"/>

    <!-- script -->
    <path path="core/languageDesign/script/source/jetbrains/mps/lang/script/runtime"/>
    <path path="core/languageDesign/script/source/jetbrains/mps/lang/script/util"/>
    <path path="core/languageDesign/script/source_gen/jetbrains/mps/lang/script/generator"/>
    <path path="core/languageDesign/script/source_gen/jetbrains/mps/lang/script/structure"/>
    <path path="core/languageDesign/script/source_gen/jetbrains/mps/lang/script/typesystem"/>

    <!-- sharedConcepts -->
    <path path="core/languageDesign/sharedConcepts/source_gen/jetbrains/mps/lang/sharedConcepts/behavior"/>
    <path path="core/languageDesign/sharedConcepts/source_gen/jetbrains/mps/lang/sharedConcepts/generator"/>
    <path path="core/languageDesign/sharedConcepts/source_gen/jetbrains/mps/lang/sharedConcepts/structure"/>

    <!-- smodel -->
    <path path="core/languageDesign/smodel/source"/>
    <path path="core/languageDesign/smodel/source_gen/jetbrains/mps/lang/smodel/behavior"/>
    <path path="core/languageDesign/smodel/source_gen/jetbrains/mps/lang/smodel/generator"/>
    <path path="core/languageDesign/smodel/source_gen/jetbrains/mps/lang/smodel/structure"/>
    <path path="core/languageDesign/smodel/source_gen/jetbrains/mps/lang/smodel/typesystem"/>

    <!-- structure -->
    <path path="core/languageDesign/structure/source/jetbrains/mps/lang/structure/constraints"/>
    <path path="core/languageDesign/structure/source_gen/jetbrains/mps/lang/structure/behavior"/>
    <path path="core/languageDesign/structure/source_gen/jetbrains/mps/lang/structure/generator_new"/>
    <path path="core/languageDesign/structure/source_gen/jetbrains/mps/lang/structure/structure"/>
    <path path="core/languageDesign/structure/source_gen/jetbrains/mps/lang/structure/typesystem"/>

    <!-- stubs -->
    <path path="core/languageDesign/stubs/source_gen/jetbrains/mps/lang/stubs/behavior"/>
    <path path="core/languageDesign/stubs/source_gen/jetbrains/mps/lang/stubs/generator"/>
    <path path="core/languageDesign/stubs/source_gen/jetbrains/mps/lang/stubs/structure"/>
    <path path="core/languageDesign/stubs/source_gen/jetbrains/mps/lang/stubs/typesystem"/>

    <!-- test -->
    <path path="core/languageDesign/test/source_gen/jetbrains/mps/lang/test/structure"/>

    <!-- textGen -->
    <path path="core/languageDesign/textGen/source"/>
    <path path="core/languageDesign/textGen/source_gen/jetbrains/mps/lang/textGen/behavior"/>
    <path path="core/languageDesign/textGen/source_gen/jetbrains/mps/lang/textGen/generator"/>
    <path path="core/languageDesign/textGen/source_gen/jetbrains/mps/lang/textGen/structure"/>
    <path path="core/languageDesign/textGen/source_gen/jetbrains/mps/lang/textGen/typesystem"/>

    <!-- typesystem -->
    <path path="core/languageDesign/typesystem/source_gen/jetbrains/mps/lang/typesystem/behavior"/>
    <path path="core/languageDesign/typesystem/source_gen/jetbrains/mps/lang/typesystem/generator"/>
    <path path="core/languageDesign/typesystem/source_gen/jetbrains/mps/lang/typesystem/structure"/>
    <path path="core/languageDesign/typesystem/source_gen/jetbrains/mps/lang/typesystem/typesystem"/>


    <dirset dir="core/baseLanguage">
      <include name="**/source/**/structure"/>
      <include name="**/source_gen/**/structure"/>
      <include name="**/source/**/behavior"/>
      <include name="**/source_gen/**/behavior"/>
      <include name="**/source/**/generator"/>
      <include name="**/source_gen/**/generator"/>
      <include name="**/source/**/textGen"/>
      <include name="**/source_gen/**/textGen"/>
      <include name="collections/runtime/source_gen"/>
    </dirset>
  </path>

  <path id="core.classpath">
    <fileset dir="lib" includes="*.jar"/>
    <path path="lib/commons-lang/commons-lang-2.1.jar" />
    <path path="lib/commons-logging/commons-logging-1.1.jar" />
    <path path="lib/eclipse-compiler/ecj.jar" />
    <path path="lib/jdom/jdom.jar" />
    <path path="lib/junit4/junit-4.8.2.jar" />
    <path path="lib/log4j/log4j.jar" />
    <path path="lib/asm/asm.jar" />
    <path path="lib/trove4j/trove4j.jar" />
  </path>

  <target name="clean">
    <delete dir="tempbuild"/>
  </target>

  <target name="compile" depends="clean">
    <mkdir dir="tempbuild"/>

    <javac classpathref="core.classpath" destdir="tempbuild" fork="true" memorymaximumsize="1024m" source="1.5">
      <src>
        <path refid="core.sources"/>
      </src>
    </javac>
  </target>
</project>