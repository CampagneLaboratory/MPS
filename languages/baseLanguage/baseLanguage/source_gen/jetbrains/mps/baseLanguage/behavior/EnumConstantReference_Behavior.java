package jetbrains.mps.baseLanguage.behavior;

/*Generated by MPS */

import jetbrains.mps.smodel.SNode;
import jetbrains.mps.project.IModule;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.reloading.ReflectionUtil;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.scope.Scope;
import jetbrains.mps.lang.scopes.runtime.NamedElementsScope;
import jetbrains.mps.baseLanguage.scopes.Members;
import jetbrains.mps.scope.EmptyScope;
import jetbrains.mps.smodel.SModelDescriptor;

public class EnumConstantReference_Behavior {
  public static void init(SNode thisNode) {
  }

  public static Object virtual_eval_1213877519769(SNode thisNode, IModule module) {
    SNode enumClass = SLinkOperations.getTarget(thisNode, "enumClass", false);
    SNode e = SLinkOperations.getTarget(thisNode, "enumConstantDeclaration", false);
    IModule m = check_p8mh91_a0c0a(SNodeOperations.getModel(e).getModelDescriptor());
    if (m != null) {
      Enum eClass = null;
      try {
        eClass = ReflectionUtil.getEnum(m, enumClass, SPropertyOperations.getString(e, "name"));
      } catch (Throwable t) {
        // do nothing 
      }
      if (eClass != null) {
        return eClass;
      }
    }
    return ReflectionUtil.getEnum(module, enumClass, SPropertyOperations.getString(e, "name"));
  }

  public static Scope virtual_getScope_3734116213129936182(SNode thisNode, SNode kind, SNode child) {
    return ((SLinkOperations.getTarget(thisNode, "enumClass", false) != null) ?
      new NamedElementsScope(Members.visibleEnumConstants(SLinkOperations.getTarget(thisNode, "enumClass", false))) :
      new EmptyScope()
    );
  }

  private static IModule check_p8mh91_a0c0a(SModelDescriptor checkedDotOperand) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.getModule();
    }
    return null;
  }
}
