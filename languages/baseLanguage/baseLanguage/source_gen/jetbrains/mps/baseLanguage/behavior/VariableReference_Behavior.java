package jetbrains.mps.baseLanguage.behavior;

/*Generated by MPS */

import jetbrains.mps.smodel.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.project.IModule;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.smodel.SModelStereotype;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.reloading.ReflectionUtil;
import jetbrains.mps.smodel.SModelDescriptor;

public class VariableReference_Behavior {
  public static void init(SNode thisNode) {
  }

  public static SNode virtual_getTypeAnnotation_1233920952262(SNode thisNode) {
    return TypeAnnotable_Behavior.call_getTypeAnnotation_1233920952262(SLinkOperations.getTarget(thisNode, "variableDeclaration", false));
  }

  public static SNode virtual_getVariable_1023687332192481693(SNode thisNode) {
    return SLinkOperations.getTarget(thisNode, "variableDeclaration", false);
  }

  public static Object virtual_getCompileTimeConstantValue_1238860310638(SNode thisNode, IModule module) {
    if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.StaticFieldDeclaration")) {
      // todo 
      SNode declaration = SNodeOperations.cast(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.StaticFieldDeclaration");
      SNode classifier = SNodeOperations.as(SNodeOperations.getParent(declaration), "jetbrains.mps.baseLanguage.structure.Classifier");
      if ((classifier != null) && SModelStereotype.isStubModelStereotype(SNodeOperations.getModel(classifier).getSModelReference().getStereotype())) {
        return Expression_Behavior.call_eval_1213877519769(thisNode, module);
      } else {
        return (Expression_Behavior.call_isCompileTimeConstant_1238860258777(SLinkOperations.getTarget(declaration, "initializer", true)) ?
          Expression_Behavior.call_getCompileTimeConstantValue_1238860310638(SLinkOperations.getTarget(declaration, "initializer", true), module) :
          null
        );
      }
    }

    return Expression_Behavior.callSuperNew_getCompileTimeConstantValue_1238860310638(thisNode, "jetbrains.mps.baseLanguage.structure.Expression", module);
  }

  public static boolean virtual_isCompileTimeConstant_1238860258777(SNode thisNode) {
    if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.StaticFieldDeclaration")) {
      // todo 
      SNode declaration = SNodeOperations.cast(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.StaticFieldDeclaration");
      return SPropertyOperations.getBoolean(declaration, "isFinal");
    }

    return Expression_Behavior.callSuperNew_isCompileTimeConstant_1238860258777(thisNode, "jetbrains.mps.baseLanguage.structure.Expression");
  }

  public static Object virtual_eval_1213877519769(SNode thisNode, IModule module) {
    if (SNodeOperations.isInstanceOf(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.StaticFieldDeclaration")) {
      // todo 
      SNode declaration = SNodeOperations.cast(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.StaticFieldDeclaration");
      SNode classifier = SNodeOperations.as(SNodeOperations.getParent(declaration), "jetbrains.mps.baseLanguage.structure.Classifier");

      IModule m = check_gidzrl_a0e0a0e(SNodeOperations.getModel(declaration).getModelDescriptor());
      if (m != null) {
        Object c = null;
        try {
          c = ReflectionUtil.getConstant(m, classifier, SPropertyOperations.getString(declaration, "name"));
        } catch (Throwable t) {
          // do nothing 
        }
        if (c != null) {
          return c;
        }
      }
      return ReflectionUtil.getConstant(module, classifier, SPropertyOperations.getString(declaration, "name"));
    }

    return Expression_Behavior.callSuperNew_eval_1213877519769(thisNode, "jetbrains.mps.baseLanguage.structure.Expression", module);
  }

  public static boolean call_isParameterOfThisMethod_1240394425603(SNode thisNode) {
    // todo: method from Parameter reference. Remove. 
    if (!(SNodeOperations.isInstanceOf(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.ParameterDeclaration"))) {
      throw new IllegalArgumentException();
    }
    if (SNodeOperations.getAncestor(thisNode, "jetbrains.mps.baseLanguage.structure.BaseMethodDeclaration", false, false) == SNodeOperations.getAncestor(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.BaseMethodDeclaration", false, false)) {
      if (SNodeOperations.getAncestor(thisNode, "jetbrains.mps.baseLanguage.structure.Closureoid", false, false) == SNodeOperations.getAncestor(SLinkOperations.getTarget(thisNode, "variableDeclaration", false), "jetbrains.mps.baseLanguage.structure.Closureoid", false, false)) {
        return true;
      }
    }
    return false;
  }

  private static IModule check_gidzrl_a0e0a0e(SModelDescriptor checkedDotOperand) {
    if (null != checkedDotOperand) {
      return checkedDotOperand.getModule();
    }
    return null;
  }
}
