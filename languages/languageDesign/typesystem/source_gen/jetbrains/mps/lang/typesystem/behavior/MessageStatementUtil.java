package jetbrains.mps.lang.typesystem.behavior;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import java.util.List;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;

public class MessageStatementUtil {
  public static final int MIN_LENGTH = 3;

;;;  private static final int MAX_LENGTH = 20;

;;;  public static String generateNameFromExpression(SNode expr) {
    List<SNode> descendants = SNodeOperations.getDescendants(expr, "jetbrains.mps.baseLanguage.structure.StringLiteral", true, new String[]{});
    if (ListSequence.fromList(descendants).isEmpty()) {
      return null;
    }
    return convertToCamelCaseNameString(SPropertyOperations.getString(ListSequence.fromList(descendants).last(), "value"));
  };;
;
;;;  private static String convertToCamelCaseNameString(String nameString) {
    String[] tokens = nameString.split(" ");
    String result = "";
    for (String token : tokens) {
      if (result.length() > MAX_LENGTH) {
        break;
      }
      result += convertTokenToCamelCase(token);
    }
    return result;
  };;
;
;;;  private static String convertTokenToCamelCase(String token) {
    token = clearNameFromNonJavaSymbols(token);
    if (token.length() <= 1) {
      return "";
    }
    return token.substring(0, 1).toUpperCase() + token.substring(1).toLowerCase();
  };;
;
;;;  private static String clearNameFromNonJavaSymbols(String name) {
    name = name.toLowerCase();
    String res = "";
    for (int i = 0; i < name.length(); ++i) {
      if (name.charAt(i) >= 'a' && name.charAt(i) <= 'z') {
        res += name.charAt(i);
      }
    }
    return res;
  };;
;
;;;}
