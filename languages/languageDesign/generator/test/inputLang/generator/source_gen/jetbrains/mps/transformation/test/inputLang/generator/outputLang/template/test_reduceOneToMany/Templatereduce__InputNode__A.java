package jetbrains.mps.transformation.test.inputLang.generator.outputLang.template.test_reduceOneToMany;

/*Generated by MPS */

import jetbrains.mps.generator.runtime.Generated;
import jetbrains.mps.generator.runtime.TemplateDeclarationWeavingAware;
import org.jetbrains.mps.openapi.model.SNodeReference;
import jetbrains.mps.smodel.SNodePointer;
import java.util.Collection;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.generator.runtime.TemplateExecutionEnvironment;
import jetbrains.mps.generator.runtime.TemplateContext;
import jetbrains.mps.generator.runtime.GenerationException;
import java.util.List;
import java.util.ArrayList;
import jetbrains.mps.generator.template.SourceSubstituteMacroNodesContext;
import org.jetbrains.mps.openapi.model.SNodeAccessUtil;
import jetbrains.mps.generator.runtime.TemplateUtil;

@Generated
public class Templatereduce__InputNode__A implements TemplateDeclarationWeavingAware {
  public Templatereduce__InputNode__A() {
  }

  public SNodeReference getTemplateNode() {
    return new SNodePointer("r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691(jetbrains.mps.transformation.test.inputLang.generator.outputLang.template.test_reduceOneToMany@generator)", "3893401255414100167");
  }

  protected Collection<SNode> applyPart0(@NotNull final TemplateExecutionEnvironment environment, @NotNull final TemplateContext context) throws GenerationException {
    final List<SNode> tlist1 = new ArrayList<SNode>();
    final Iterable<SNode> loopList1 = QueriesGenerated.sourceNodesQuery_3893401255414161783(new SourceSubstituteMacroNodesContext(context, loopMacroRef_b8tv7e_b0a0a1a2));
    for (SNode itnode1 : loopList1) {
      if (itnode1 == null) {
        continue;
      }
      TemplateContext context1 = context.subContext(null, itnode1);
      final SNode tnode2 = environment.createOutputNode("jetbrains.mps.transformation.test.outputLang.structure.OutputNode");
      try {
        environment.nodeCopied(context1, tnode2, "tpl/r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691/3893401255414100171");
        SNodeAccessUtil.setProperty(tnode2, "text", "child #1");
      } finally {
      }
      if (tnode2 != null) {
        tlist1.add(tnode2);
      }
    }
    return tlist1;
  }

  protected SNode applyPart1(@NotNull final TemplateExecutionEnvironment environment, @NotNull final TemplateContext context) throws GenerationException {
    final SNode tnode3 = environment.createOutputNode("jetbrains.mps.transformation.test.outputLang.structure.OutputNode");
    try {
      environment.nodeCopied(context, tnode3, "tpl/r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691/1391450457158185608");
      SNodeAccessUtil.setProperty(tnode3, "text", "child #2");
    } finally {
    }
    return tnode3;
  }

  protected Collection<SNode> applyPart2(@NotNull final TemplateExecutionEnvironment environment, @NotNull final TemplateContext context) throws GenerationException {
    Collection<SNode> tlist4 = null;
    try {
      try {
        tlist4 = new Templatereduce__InputNode__A__included().apply(environment, context);
      } finally {
      }

    } finally {
    }
    return tlist4;
  }

  protected Collection<SNode> applyPart3(@NotNull final TemplateExecutionEnvironment environment, @NotNull final TemplateContext context) throws GenerationException {
    Collection<SNode> tlist5 = null;
    try {
      try {
        tlist5 = environment.trySwitch(templateSwitchNodeNoInput_b8tv7e_a0a0a0a0b0f, context);
        if (tlist5 == null) {
          final SNode tnode6 = environment.createOutputNode("jetbrains.mps.transformation.test.outputLang.structure.OutputNode");
          try {
            environment.nodeCopied(context, tnode6, "tpl/r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691/1892993302480310362");
          } finally {
          }
          if (tnode6 != null) {
            tlist5 = TemplateUtil.singletonList(tnode6);
          }
        }
      } finally {
      }
    } finally {
    }
    return tlist5;
  }

  public Collection<SNode> apply(@NotNull TemplateExecutionEnvironment environment, @NotNull TemplateContext context) throws GenerationException {
    return TemplateUtil.asList(applyPart0(environment, context), applyPart1(environment, context), applyPart2(environment, context), applyPart3(environment, context));
  }

  public Collection<SNode> weave(@NotNull TemplateExecutionEnvironment environment, @NotNull TemplateContext context, @NotNull SNode outputContextNode) throws GenerationException {
    Collection<SNode> tlistpart0 = applyPart0(environment, context);
    SNodeReference weaveTf0 = weaveTfConst_b8tv7e_a0b0h;
    for (SNode nodeToWeave : TemplateUtil.asNotNull(tlistpart0)) {
      environment.weaveNode(outputContextNode, "outputChild", nodeToWeave, weaveTf0, context.getInput());
    }
    SNode tnodepart1 = applyPart1(environment, context);
    SNodeReference weaveTf1 = weaveTfConst_b8tv7e_a0e0h;
    environment.weaveNode(outputContextNode, "outputChild", tnodepart1, weaveTf1, context.getInput());
    Collection<SNode> tlistpart2 = applyPart2(environment, context);
    SNodeReference weaveTf2 = weaveTfConst_b8tv7e_a0h0h;
    for (SNode nodeToWeave : TemplateUtil.asNotNull(tlistpart2)) {
      environment.weaveNode(outputContextNode, "outputChild", nodeToWeave, weaveTf2, context.getInput());
    }
    Collection<SNode> tlistpart3 = applyPart3(environment, context);
    SNodeReference weaveTf3 = weaveTfConst_b8tv7e_a0k0h;
    for (SNode nodeToWeave : TemplateUtil.asNotNull(tlistpart3)) {
      environment.weaveNode(outputContextNode, "outputChild", nodeToWeave, weaveTf3, context.getInput());
    }
    return TemplateUtil.asList(tlistpart0, tnodepart1, tlistpart2, tlistpart3);
  }

  private static SNodePointer loopMacroRef_b8tv7e_b0a0a1a2 = new SNodePointer("r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691(jetbrains.mps.transformation.test.inputLang.generator.outputLang.template.test_reduceOneToMany@generator)", "3893401255414161782");
  private static SNodePointer templateSwitchNodeNoInput_b8tv7e_a0a0a0a0b0f = new SNodePointer("r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691(jetbrains.mps.transformation.test.inputLang.generator.outputLang.template.test_reduceOneToMany@generator)", "1892993302480310366");
  private static SNodePointer weaveTfConst_b8tv7e_a0b0h = new SNodePointer("r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691(jetbrains.mps.transformation.test.inputLang.generator.outputLang.template.test_reduceOneToMany@generator)", "3893401255414100173");
  private static SNodePointer weaveTfConst_b8tv7e_a0e0h = new SNodePointer("r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691(jetbrains.mps.transformation.test.inputLang.generator.outputLang.template.test_reduceOneToMany@generator)", "1391450457158185609");
  private static SNodePointer weaveTfConst_b8tv7e_a0h0h = new SNodePointer("r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691(jetbrains.mps.transformation.test.inputLang.generator.outputLang.template.test_reduceOneToMany@generator)", "1892993302480068637");
  private static SNodePointer weaveTfConst_b8tv7e_a0k0h = new SNodePointer("r:eca8e1c7-93fd-4ddf-9db6-91f9c2320691(jetbrains.mps.transformation.test.inputLang.generator.outputLang.template.test_reduceOneToMany@generator)", "1892993302480310363");
}
