package jetbrains.mps.lang.structure.pluginSolution.plugin;

/*Generated by MPS */

import com.intellij.openapi.ui.DialogWrapper;
import jetbrains.mps.project.MPSProject;
import javax.swing.JPanel;
import javax.swing.JLabel;
import javax.swing.Action;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;
import com.intellij.openapi.project.Project;
import org.jetbrains.annotations.Nullable;
import javax.swing.JComponent;
import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;
import java.awt.Insets;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import javax.swing.AbstractAction;
import java.awt.event.ActionEvent;

public class ConceptPropertiesMigrationDialog extends DialogWrapper {
  private MPSProject mpsProject;
  private JPanel myPanel;
  protected JLabel myLabel = new JLabel();
  private Action myMigrateAction;
  private _FunctionTypes._void_P0_E0 action;

  public ConceptPropertiesMigrationDialog(Project project, MPSProject mpsProject) {
    super(project);
    this.mpsProject = mpsProject;
    init();
    setResizable(false);
  }

  @Nullable
  protected JComponent createCenterPanel() {
    myPanel = new JPanel(new GridBagLayout());
    GridBagConstraints c = new GridBagConstraints();
    c.gridx = 0;
    c.gridy = 0;
    c.weightx = 0;
    c.anchor = GridBagConstraints.FIRST_LINE_START;
    c.insets = new Insets(4, 8, 8, 8);
    myPanel.add(myLabel, c);
    return myPanel;
  }

  public void setAction(_FunctionTypes._void_P0_E0 action) {
    this.action = action;
  }

  public void setText(String labelText) {
    myLabel.setText(labelText);
  }

  protected Action[] createActions() {
    List<Action> actions = ListSequence.fromList(new ArrayList<Action>());
    ListSequence.fromList(actions).addElement(getCancelAction());
    ListSequence.fromList(actions).addElement(myMigrateAction);
    return ListSequence.fromList(actions).toGenericArray(Action.class);
  }

  @Override
  protected void createDefaultActions() {
    super.createDefaultActions();
    myMigrateAction = new ConceptPropertiesMigrationDialog.MigrateAction();
  }

  private void doMigrate() {
    this.close(OK_EXIT_CODE);
    action.invoke();
  }

  private class MigrateAction extends AbstractAction {
    public MigrateAction() {
      putValue(NAME, "Migrate");
      putValue(DEFAULT_ACTION, Boolean.TRUE);
    }

    public void actionPerformed(ActionEvent event) {
      doMigrate();
    }
  }
}
