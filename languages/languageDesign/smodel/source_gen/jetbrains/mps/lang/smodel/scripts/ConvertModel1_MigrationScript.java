package jetbrains.mps.lang.smodel.scripts;

/*Generated by MPS */

import jetbrains.mps.lang.script.runtime.BaseMigrationScript;
import jetbrains.mps.smodel.IOperationContext;
import jetbrains.mps.lang.script.runtime.AbstractMigrationRefactoring;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.pattern.GeneratedMatchingPattern;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.pattern.IMatchingPattern;
import jetbrains.mps.lang.pattern.runtime.PatternUtil;
import jetbrains.mps.util.IterableUtil;
import org.jetbrains.mps.openapi.model.SNodeReference;
import jetbrains.mps.smodel.SModelUtil_new;
import jetbrains.mps.project.GlobalScope;
import jetbrains.mps.smodel.SReference;
import jetbrains.mps.smodel.SModelReference;
import jetbrains.mps.smodel.SNodeId;
import jetbrains.mps.lang.typesystem.runtime.HUtil;
import jetbrains.mps.smodel.SNodePointer;

public class ConvertModel1_MigrationScript extends BaseMigrationScript {
  public ConvertModel1_MigrationScript(IOperationContext operationContext) {
    super("Convert Model - stage 1");
    this.addRefactoring(new AbstractMigrationRefactoring(operationContext) {
      public String getName() {
        return "<node>.getModel.getModelDescriptor() -> <node>.getContainingModel()";
      }

      public String getAdditionalInfo() {
        return "<node>.getModel.getModelDescriptor() -> <node>.getContainingModel()";
      }

      public String getFqNameOfConceptToSearchInstances() {
        return "jetbrains.mps.baseLanguage.structure.DotExpression";
      }

      public boolean isApplicableInstanceNode(SNode node) {
        {
          SNode matchedNode_lbr3d9_a0a0_0 = node;
          {
            boolean matches_lbr3d9_a0a0a_0 = false;
            GeneratedMatchingPattern matchingPattern = new ConvertModel1_MigrationScript.Pattern_n40gje_a0a1a1a0a3a0a0a0a1a0();
            matches_lbr3d9_a0a0a_0 = matchingPattern.match(matchedNode_lbr3d9_a0a0_0);
            if (matches_lbr3d9_a0a0a_0) {
              return true;
            } else
            return false;
          }
        }
      }

      public void doUpdateInstanceNode(SNode node) {
        {
          SNode matchedNode_lbr3d9_a0a0 = node;
          {
            boolean matches_lbr3d9_a0a0a = false;
            GeneratedMatchingPattern matchingPattern = new ConvertModel1_MigrationScript.Pattern_n40gje_a0a1a1a0a4a0a0a0a1a0();
            matches_lbr3d9_a0a0a = matchingPattern.match(matchedNode_lbr3d9_a0a0);
            if (matches_lbr3d9_a0a0a) {
              SNodeOperations.replaceWithAnother(node, _quotation_createNode_lbr3d9_a0a0a0a3a1a0a0a(((SNode) matchingPattern.getFieldValue("patternVar_node"))));
            }
          }
        }
      }

      public boolean isShowAsIntention() {
        return false;
      }
    });
  }

  public static class Pattern_n40gje_a0a1a1a0a3a0a0a0a1a0 extends GeneratedMatchingPattern implements IMatchingPattern {
    /*package*/ SNode patternVar_node;

    public Pattern_n40gje_a0a1a1a0a3a0a0a0a1a0() {
    }

    public boolean match(SNode nodeToMatch) {
      {
        SNode nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0_0;
        nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0_0 = nodeToMatch;
        if (!("jetbrains.mps.baseLanguage.structure.DotExpression".equals(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0_0.getConcept().getConceptId()))) {
          return false;
        }
        {
          String childRole_ConvertModel1_lbr3d9__3 = "operand";
          if (!(PatternUtil.hasNChildren(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0_0, childRole_ConvertModel1_lbr3d9__3, 1))) {
            return false;
          }
          {
            SNode childVar_ConvertModel1_lbr3d9_a0a0a0a0a_1 = IterableUtil.get(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0_0.getChildren(childRole_ConvertModel1_lbr3d9__3), 0);
            {
              SNode nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_1;
              nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_1 = childVar_ConvertModel1_lbr3d9_a0a0a0a0a_1;
              if (!("jetbrains.mps.baseLanguage.structure.DotExpression".equals(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_1.getConcept().getConceptId()))) {
                return false;
              }
              {
                String childRole_ConvertModel1_lbr3d9__4 = "operation";
                if (!(PatternUtil.hasNChildren(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_1, childRole_ConvertModel1_lbr3d9__4, 1))) {
                  return false;
                }
                {
                  SNode childVar_ConvertModel1_lbr3d9_a0a0a0a0a0_1 = IterableUtil.get(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_1.getChildren(childRole_ConvertModel1_lbr3d9__4), 0);
                  {
                    SNode nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a0_0;
                    nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a0_0 = childVar_ConvertModel1_lbr3d9_a0a0a0a0a0_1;
                    if (!("jetbrains.mps.baseLanguage.structure.InstanceMethodCallOperation".equals(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a0_0.getConcept().getConceptId()))) {
                      return false;
                    }
                    {
                      SNodeReference pointer = SNODE_POINTER_n40gje_a0a0a0a0b0c0b0b0b0a0b0c0b0b0b0a0b0c0a0a0a0b0b0a0d0a0a0a0b0a;
                      if (!(PatternUtil.matchReferentWithNode(pointer, nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a0_0.getReferenceTarget("baseMethodDeclaration")))) {
                        return false;
                      }
                    }
                  }
                }
              }
              {
                String childRole_ConvertModel1_lbr3d9__5 = "operand";
                if (!(PatternUtil.hasNChildren(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_1, childRole_ConvertModel1_lbr3d9__5, 1))) {
                  return false;
                }
                {
                  SNode childVar_ConvertModel1_lbr3d9_a0a0a0a0a0_2 = IterableUtil.get(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_1.getChildren(childRole_ConvertModel1_lbr3d9__5), 0);
                  this.patternVar_node = childVar_ConvertModel1_lbr3d9_a0a0a0a0a0_2;
                }
              }
            }
          }
        }
        {
          String childRole_ConvertModel1_lbr3d9__6 = "operation";
          if (!(PatternUtil.hasNChildren(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0_0, childRole_ConvertModel1_lbr3d9__6, 1))) {
            return false;
          }
          {
            SNode childVar_ConvertModel1_lbr3d9_a0a0a0a0a_2 = IterableUtil.get(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0_0.getChildren(childRole_ConvertModel1_lbr3d9__6), 0);
            {
              SNode nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_2;
              nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_2 = childVar_ConvertModel1_lbr3d9_a0a0a0a0a_2;
              if (!("jetbrains.mps.baseLanguage.structure.InstanceMethodCallOperation".equals(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_2.getConcept().getConceptId()))) {
                return false;
              }
              {
                SNodeReference pointer = SNODE_POINTER_n40gje_a0a0a0a0b0c0b0b0b0b0b0c0a0a0a0b0b0a0d0a0a0a0b0a;
                if (!(PatternUtil.matchReferentWithNode(pointer, nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_2.getReferenceTarget("baseMethodDeclaration")))) {
                  return false;
                }
              }
            }
          }
        }
      }
      return true;
    }

    public boolean hasAntiquotations() {
      return false;
    }

    public void fillFieldValuesFrom(GeneratedMatchingPattern pattern) {
      if (pattern != null && pattern.getClass() == this.getClass()) {
        patternVar_node = (SNode) pattern.getFieldValue("patternVar_node");
      }
    }

    public Object getFieldValue(String fieldName) {
      if ("patternVar_node".equals(fieldName)) {
        return patternVar_node;
      }
      return null;
    }

    public void performActions(Object o) {
    }
  }

  public static class Pattern_n40gje_a0a1a1a0a4a0a0a0a1a0 extends GeneratedMatchingPattern implements IMatchingPattern {
    /*package*/ SNode patternVar_node;

    public Pattern_n40gje_a0a1a1a0a4a0a0a0a1a0() {
    }

    public boolean match(SNode nodeToMatch) {
      {
        SNode nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0;
        nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0 = nodeToMatch;
        if (!("jetbrains.mps.baseLanguage.structure.DotExpression".equals(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0.getConcept().getConceptId()))) {
          return false;
        }
        {
          String childRole_ConvertModel1_lbr3d9_ = "operand";
          if (!(PatternUtil.hasNChildren(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0, childRole_ConvertModel1_lbr3d9_, 1))) {
            return false;
          }
          {
            SNode childVar_ConvertModel1_lbr3d9_a0a0a0a0a = IterableUtil.get(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0.getChildren(childRole_ConvertModel1_lbr3d9_), 0);
            {
              SNode nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a;
              nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a = childVar_ConvertModel1_lbr3d9_a0a0a0a0a;
              if (!("jetbrains.mps.baseLanguage.structure.DotExpression".equals(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a.getConcept().getConceptId()))) {
                return false;
              }
              {
                String childRole_ConvertModel1_lbr3d9__0 = "operation";
                if (!(PatternUtil.hasNChildren(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a, childRole_ConvertModel1_lbr3d9__0, 1))) {
                  return false;
                }
                {
                  SNode childVar_ConvertModel1_lbr3d9_a0a0a0a0a0 = IterableUtil.get(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a.getChildren(childRole_ConvertModel1_lbr3d9__0), 0);
                  {
                    SNode nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a0;
                    nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a0 = childVar_ConvertModel1_lbr3d9_a0a0a0a0a0;
                    if (!("jetbrains.mps.baseLanguage.structure.InstanceMethodCallOperation".equals(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a0.getConcept().getConceptId()))) {
                      return false;
                    }
                    {
                      SNodeReference pointer = SNODE_POINTER_n40gje_a0a0a0a0b0c0b0b0b0a0b0c0b0b0b0a0b0c0a0a0a0b0b0a0e0a0a0a0b0a;
                      if (!(PatternUtil.matchReferentWithNode(pointer, nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a0.getReferenceTarget("baseMethodDeclaration")))) {
                        return false;
                      }
                    }
                  }
                }
              }
              {
                String childRole_ConvertModel1_lbr3d9__1 = "operand";
                if (!(PatternUtil.hasNChildren(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a, childRole_ConvertModel1_lbr3d9__1, 1))) {
                  return false;
                }
                {
                  SNode childVar_ConvertModel1_lbr3d9_a0a0a0a0a0_0 = IterableUtil.get(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a.getChildren(childRole_ConvertModel1_lbr3d9__1), 0);
                  this.patternVar_node = childVar_ConvertModel1_lbr3d9_a0a0a0a0a0_0;
                }
              }
            }
          }
        }
        {
          String childRole_ConvertModel1_lbr3d9__2 = "operation";
          if (!(PatternUtil.hasNChildren(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0, childRole_ConvertModel1_lbr3d9__2, 1))) {
            return false;
          }
          {
            SNode childVar_ConvertModel1_lbr3d9_a0a0a0a0a_0 = IterableUtil.get(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0.getChildren(childRole_ConvertModel1_lbr3d9__2), 0);
            {
              SNode nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_0;
              nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_0 = childVar_ConvertModel1_lbr3d9_a0a0a0a0a_0;
              if (!("jetbrains.mps.baseLanguage.structure.InstanceMethodCallOperation".equals(nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_0.getConcept().getConceptId()))) {
                return false;
              }
              {
                SNodeReference pointer = SNODE_POINTER_n40gje_a0a0a0a0b0c0b0b0b0b0b0c0a0a0a0b0b0a0e0a0a0a0b0a;
                if (!(PatternUtil.matchReferentWithNode(pointer, nodeToMatch_ConvertModel1_lbr3d9_a0a0a0a0a_0.getReferenceTarget("baseMethodDeclaration")))) {
                  return false;
                }
              }
            }
          }
        }
      }
      return true;
    }

    public boolean hasAntiquotations() {
      return false;
    }

    public void fillFieldValuesFrom(GeneratedMatchingPattern pattern) {
      if (pattern != null && pattern.getClass() == this.getClass()) {
        patternVar_node = (SNode) pattern.getFieldValue("patternVar_node");
      }
    }

    public Object getFieldValue(String fieldName) {
      if ("patternVar_node".equals(fieldName)) {
        return patternVar_node;
      }
      return null;
    }

    public void performActions(Object o) {
    }
  }

  private static SNode _quotation_createNode_lbr3d9_a0a0a0a3a1a0a0a(Object parameter_1) {
    SNode quotedNode_2 = null;
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.DotExpression", null, null, GlobalScope.getInstance(), false);
    quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.InstanceMethodCallOperation", null, null, GlobalScope.getInstance(), false);
    quotedNode_3.setReference("baseMethodDeclaration", SReference.create("baseMethodDeclaration", quotedNode_3, SModelReference.fromString("f:java_stub#6ed54515-acc8-4d1e-a16c-9fd6cfe951ea#jetbrains.mps.smodel(MPS.Core/jetbrains.mps.smodel@java_stub)"), SNodeId.fromString("~SNode.getContainingModel():org.jetbrains.mps.openapi.model.SModel")));
    quotedNode_2.addChild("operation", quotedNode_3);
    quotedNode_4 = (SNode) parameter_1;
    if (quotedNode_4 != null) {
      quotedNode_2.addChild("operand", HUtil.copyIfNecessary(quotedNode_4));
    }
    return quotedNode_2;
  }

  private static SNodePointer SNODE_POINTER_n40gje_a0a0a0a0b0c0b0b0b0a0b0c0b0b0b0a0b0c0a0a0a0b0b0a0d0a0a0a0b0a = new SNodePointer("f:java_stub#8865b7a8-5271-43d3-884c-6fd1d9cfdd34#org.jetbrains.mps.openapi.model(MPS.OpenAPI/org.jetbrains.mps.openapi.model@java_stub)", "~SNode.getModel():org.jetbrains.mps.openapi.model.SModel");
  private static SNodePointer SNODE_POINTER_n40gje_a0a0a0a0b0c0b0b0b0b0b0c0a0a0a0b0b0a0d0a0a0a0b0a = new SNodePointer("f:java_stub#8865b7a8-5271-43d3-884c-6fd1d9cfdd34#org.jetbrains.mps.openapi.model(MPS.OpenAPI/org.jetbrains.mps.openapi.model@java_stub)", "~SModel.getModelDescriptor():jetbrains.mps.smodel.SModelInternal");
  private static SNodePointer SNODE_POINTER_n40gje_a0a0a0a0b0c0b0b0b0a0b0c0b0b0b0a0b0c0a0a0a0b0b0a0e0a0a0a0b0a = new SNodePointer("f:java_stub#8865b7a8-5271-43d3-884c-6fd1d9cfdd34#org.jetbrains.mps.openapi.model(MPS.OpenAPI/org.jetbrains.mps.openapi.model@java_stub)", "~SNode.getModel():org.jetbrains.mps.openapi.model.SModel");
  private static SNodePointer SNODE_POINTER_n40gje_a0a0a0a0b0c0b0b0b0b0b0c0a0a0a0b0b0a0e0a0a0a0b0a = new SNodePointer("f:java_stub#8865b7a8-5271-43d3-884c-6fd1d9cfdd34#org.jetbrains.mps.openapi.model(MPS.OpenAPI/org.jetbrains.mps.openapi.model@java_stub)", "~SModel.getModelDescriptor():jetbrains.mps.smodel.SModelInternal");
}
