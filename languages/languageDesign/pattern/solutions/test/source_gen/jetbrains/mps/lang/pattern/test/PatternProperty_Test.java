package jetbrains.mps.lang.pattern.test;

/*Generated by MPS */

import jetbrains.mps.MPSLaunch;
import jetbrains.mps.lang.test.runtime.BaseTransformationTest4;
import org.junit.Test;
import jetbrains.mps.lang.test.runtime.BaseTestBody;
import junit.framework.TestCase;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.pattern.GeneratedMatchingPattern;
import junit.framework.Assert;
import jetbrains.mps.lang.pattern.IMatchingPattern;
import jetbrains.mps.lang.pattern.runtime.PatternUtil;
import jetbrains.mps.util.IterableUtil;
import org.jetbrains.mps.openapi.model.SNodeAccessUtil;
import org.jetbrains.mps.openapi.persistence.PersistenceFacade;
import jetbrains.mps.smodel.SModelUtil_new;
import jetbrains.mps.project.GlobalScope;
import jetbrains.mps.smodel.SReference;

@MPSLaunch
public class PatternProperty_Test extends BaseTransformationTest4 {
  public PatternProperty_Test() {
  }

  @Test
  public void testMethod() throws Throwable {
    this.initTest("${mps_home}", "r:ef0e231b-e6bd-436f-9003-b53de4081716(jetbrains.mps.lang.pattern.test)");
    this.runTest("jetbrains.mps.lang.pattern.test.PatternProperty_Test$TestBody", "testProperty", true);
  }

  @MPSLaunch
  public static class TestBody extends BaseTestBody {
    public TestBody() {
    }

    public void testProperty() {
      TestCase.assertTrue(match());
    }

    public boolean match() {
      SNode nodeToMatch = _quotation_createNode_xihehy_a0a0c2();
      GeneratedMatchingPattern pattern = new PatternProperty_Test.TestBody.Pattern_xihehy_a0a1a2c();
      boolean matchNeeded = true;
      boolean matches = pattern.match(nodeToMatch);
      if (matchNeeded != matches) {
        return false;
      }
      if (!(matchNeeded)) {
        return true;
      }
      Assert.assertEquals("something", (String) pattern.getFieldValue("patternVar_printed"));
      return true;
    }

    public static class Pattern_xihehy_a0a1a2c extends GeneratedMatchingPattern implements IMatchingPattern {
      /*package*/ SNode patternVar_field;
      /*package*/ SNode patternVar_className;
      /*package*/ SNode patternVar_method;
      /*package*/ String patternVar_printed;

      public Pattern_xihehy_a0a1a2c() {
      }

      public boolean match(SNode nodeToMatch) {
        {
          SNode nodeToMatch_Property_ru5khm_a0;
          nodeToMatch_Property_ru5khm_a0 = nodeToMatch;
          if (!("jetbrains.mps.baseLanguage.structure.DotExpression".equals(nodeToMatch_Property_ru5khm_a0.getConcept().getConceptId()))) {
            return false;
          }
          {
            String childRole_Property_ru5khm_ = "operand";
            if (!(PatternUtil.hasNChildren(nodeToMatch_Property_ru5khm_a0, childRole_Property_ru5khm_, 1))) {
              return false;
            }
            {
              SNode childVar_Property_ru5khm_a0a = IterableUtil.get(nodeToMatch_Property_ru5khm_a0.getChildren(childRole_Property_ru5khm_), 0);
              {
                SNode nodeToMatch_Property_ru5khm_a0a;
                nodeToMatch_Property_ru5khm_a0a = childVar_Property_ru5khm_a0a;
                if (!("jetbrains.mps.baseLanguage.structure.StaticFieldReference".equals(nodeToMatch_Property_ru5khm_a0a.getConcept().getConceptId()))) {
                  return false;
                }
                patternVar_className = nodeToMatch_Property_ru5khm_a0a.getReferenceTarget("classifier");
                patternVar_field = nodeToMatch_Property_ru5khm_a0a.getReferenceTarget("variableDeclaration");
              }
            }
          }
          {
            String childRole_Property_ru5khm__0 = "operation";
            if (!(PatternUtil.hasNChildren(nodeToMatch_Property_ru5khm_a0, childRole_Property_ru5khm__0, 1))) {
              return false;
            }
            {
              SNode childVar_Property_ru5khm_a0a_0 = IterableUtil.get(nodeToMatch_Property_ru5khm_a0.getChildren(childRole_Property_ru5khm__0), 0);
              {
                SNode nodeToMatch_Property_ru5khm_a0a_0;
                nodeToMatch_Property_ru5khm_a0a_0 = childVar_Property_ru5khm_a0a_0;
                if (!("jetbrains.mps.baseLanguage.structure.InstanceMethodCallOperation".equals(nodeToMatch_Property_ru5khm_a0a_0.getConcept().getConceptId()))) {
                  return false;
                }
                patternVar_method = nodeToMatch_Property_ru5khm_a0a_0.getReferenceTarget("baseMethodDeclaration");
                {
                  String childRole_Property_ru5khm__1 = "actualArgument";
                  if (!(PatternUtil.hasNChildren(nodeToMatch_Property_ru5khm_a0a_0, childRole_Property_ru5khm__1, 1))) {
                    return false;
                  }
                  {
                    SNode childVar_Property_ru5khm_a0a0 = IterableUtil.get(nodeToMatch_Property_ru5khm_a0a_0.getChildren(childRole_Property_ru5khm__1), 0);
                    {
                      SNode nodeToMatch_Property_ru5khm_a0a0;
                      nodeToMatch_Property_ru5khm_a0a0 = childVar_Property_ru5khm_a0a0;
                      if (!("jetbrains.mps.baseLanguage.structure.StringLiteral".equals(nodeToMatch_Property_ru5khm_a0a0.getConcept().getConceptId()))) {
                        return false;
                      }
                      patternVar_printed = SNodeAccessUtil.getProperty(nodeToMatch_Property_ru5khm_a0a0, "value");
                    }
                  }
                }
              }
            }
          }
        }
        return true;
      }

      public boolean hasAntiquotations() {
        return false;
      }

      public void fillFieldValuesFrom(GeneratedMatchingPattern pattern) {
        if (pattern != null && pattern.getClass() == this.getClass()) {
          patternVar_field = (SNode) pattern.getFieldValue("patternVar_field");
          patternVar_className = (SNode) pattern.getFieldValue("patternVar_className");
          patternVar_method = (SNode) pattern.getFieldValue("patternVar_method");
          patternVar_printed = (String) pattern.getFieldValue("patternVar_printed");
        }
      }

      public Object getFieldValue(String fieldName) {
        if ("patternVar_field".equals(fieldName)) {
          return patternVar_field;
        }
        if ("patternVar_className".equals(fieldName)) {
          return patternVar_className;
        }
        if ("patternVar_method".equals(fieldName)) {
          return patternVar_method;
        }
        if ("patternVar_printed".equals(fieldName)) {
          return patternVar_printed;
        }
        return null;
      }

      public void performActions(Object o) {
      }
    }

    private static SNode _quotation_createNode_xihehy_a0a0c2() {
      PersistenceFacade facade = PersistenceFacade.getInstance();
      SNode quotedNode_1 = null;
      SNode quotedNode_2 = null;
      SNode quotedNode_3 = null;
      SNode quotedNode_4 = null;
      quotedNode_1 = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.DotExpression", null, null, GlobalScope.getInstance(), false);
      quotedNode_2 = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.StaticFieldReference", null, null, GlobalScope.getInstance(), false);
      quotedNode_2.setReference("classifier", SReference.create("classifier", quotedNode_2, facade.createModelReference("f:java_stub#6354ebe7-c22a-4a0f-ac54-50b52ab9b065#java.lang(JDK/java.lang@java_stub)"), facade.createNodeId("~System")));
      quotedNode_2.setReference("variableDeclaration", SReference.create("variableDeclaration", quotedNode_2, facade.createModelReference("f:java_stub#6354ebe7-c22a-4a0f-ac54-50b52ab9b065#java.lang(JDK/java.lang@java_stub)"), facade.createNodeId("~System.out")));
      quotedNode_1.addChild("operand", quotedNode_2);
      quotedNode_3 = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.InstanceMethodCallOperation", null, null, GlobalScope.getInstance(), false);
      quotedNode_3.setReference("baseMethodDeclaration", SReference.create("baseMethodDeclaration", quotedNode_3, facade.createModelReference("f:java_stub#6354ebe7-c22a-4a0f-ac54-50b52ab9b065#java.io(JDK/java.io@java_stub)"), facade.createNodeId("~PrintStream.println(java.lang.String):void")));
      quotedNode_4 = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.StringLiteral", null, null, GlobalScope.getInstance(), false);
      SNodeAccessUtil.setProperty(quotedNode_4, "value", "something");
      quotedNode_3.addChild("actualArgument", quotedNode_4);
      quotedNode_1.addChild("operation", quotedNode_3);
      return quotedNode_1;
    }
  }
}
