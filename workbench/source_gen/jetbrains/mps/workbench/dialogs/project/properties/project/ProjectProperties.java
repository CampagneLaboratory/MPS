package jetbrains.mps.workbench.dialogs.project.properties.project;

/*Generated by MPS */

import jetbrains.mps.project.structure.project.ProjectDescriptor;
import java.util.List;
import jetbrains.mps.project.structure.project.Path;
import jetbrains.mps.workbench.dialogs.project.components.parts.lists.ListsFactory;
import jetbrains.mps.project.structure.project.testconfigurations.BaseTestConfiguration;
import jetbrains.mps.project.MPSProject;

public class ProjectProperties {
  public static final String PROPERTY_NAME = "name";
  public static final String PROPERTY_LANGUAGES = "languages";
  public static final String PROPERTY_SOLUTIONS = "solutions";
  public static final String PROPERTY_DEVKITS = "devkits";
  public static final String PROPERTY_GEN_CONFIGS = "testConfigurations";

  private ProjectDescriptor myProjectDescriptor;
  private List<Path> mySolutions = ListsFactory.create(ListsFactory.PATH_VALID_COMPARATOR);
  private List<Path> myLanguages = ListsFactory.create(ListsFactory.PATH_VALID_COMPARATOR);
  private List<Path> myDevkits = ListsFactory.create(ListsFactory.PATH_VALID_COMPARATOR);
  private List<BaseTestConfiguration> myTestConfigs = ListsFactory.create(ListsFactory.GEN_CONF_COMPARATOR);
  private boolean myTestConfigsChanged = false;

  public ProjectProperties() {
  }

  public void testConfigsChanged() {
    myTestConfigsChanged = true;
  }

  public List<Path> getSolutions() {
    return mySolutions;
  }

  public List<Path> getLanguages() {
    return myLanguages;
  }

  public List<Path> getDevkits() {
    return myDevkits;
  }

  public List<BaseTestConfiguration> getTestConfigurations() {
    return myTestConfigs;
  }

  public boolean isSame(ProjectDescriptor projectDescriptor) {
    List<Path> paths = ListsFactory.createSortedList(ListsFactory.PATH_COMPARATOR);
    paths.clear();
    paths.addAll(myProjectDescriptor.getLanguages());
    if (!(paths.equals(myLanguages))) {
      return false;
    }
    paths.clear();
    paths.addAll(myProjectDescriptor.getSolutions());
    if (!(paths.equals(mySolutions))) {
      return false;
    }
    paths.clear();
    paths.addAll(myProjectDescriptor.getDevkits());
    if (!(paths.equals(myDevkits))) {
      return false;
    }
    return !(myTestConfigsChanged);
  }

  public void loadFrom(MPSProject project) {
    myProjectDescriptor = project.getProjectDescriptor();
    mySolutions.clear();
    mySolutions.addAll(myProjectDescriptor.getSolutions());
    myLanguages.clear();
    myLanguages.addAll(myProjectDescriptor.getLanguages());
    myDevkits.clear();
    myDevkits.addAll(myProjectDescriptor.getDevkits());
    myTestConfigs.clear();
    myTestConfigs.addAll(myProjectDescriptor.getTestConfigurations());
  }

  public void saveTo(MPSProject project) {
    myProjectDescriptor.getLanguages().clear();
    for (Path path : myLanguages) {
      myProjectDescriptor.addLanguage(path);
    }
    myProjectDescriptor.getSolutions().clear();
    for (Path path : mySolutions) {
      myProjectDescriptor.addSolution(path);
    }
    myProjectDescriptor.getDevkits().clear();
    for (Path path : myDevkits) {
      myProjectDescriptor.addDevkit(path);
    }
    myProjectDescriptor.getTestConfigurations().clear();
    myProjectDescriptor.getTestConfigurations().addAll(myTestConfigs);
    project.setProjectDescriptor(myProjectDescriptor);
  }
}
