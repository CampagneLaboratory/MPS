package jetbrains.mps.ide.properties;

/*Generated by MPS */

import jetbrains.mps.workbench.dialogs.project.BasePropertiesDialog;
import jetbrains.mps.project.DevKit;
import jetbrains.mps.smodel.IOperationContext;

public class DevKitPropertiesDialog extends BasePropertiesDialog {
  public DevKit myDevKit;
  public DevkitProperties myProperties;

  /*package*/ DevKitPropertiesDialog(DevKit devKit, IOperationContext operationContext) {
    super("DevKit Properties", operationContext);
    myDevKit = devKit;
    collectDevkitProperties();
  }

  private void collectDevkitProperties() {
    myProperties = new DevkitProperties();
    myProperties.loadFrom(myDevKit.getModuleDescriptor());
  }

  @Override
  protected boolean doSaveChanges() {
    if (!(checkValidity())) {
      return false;
    }

    getProject().getRepository().getModelAccess().executeCommand(new Runnable() {
      public void run() {
        myProperties.saveTo(myDevKit.getModuleDescriptor());
        myDevKit.setDevKitDescriptor(myDevKit.getModuleDescriptor(), true);
        myDevKit.save();
      }
    });
    return true;
  }
}
