package jetbrains.mps.ide.actions;

/*Generated by MPS */

import jetbrains.mps.ide.findusages.model.SearchResults;
import org.jetbrains.mps.openapi.module.SModule;
import com.intellij.openapi.project.Project;
import jetbrains.mps.project.MPSProject;
import jetbrains.mps.ide.dependencyViewer.DependencyViewerScope;
import jetbrains.mps.plugins.projectplugins.ProjectPluginManager;
import jetbrains.mps.ide.dependencyViewer.DependenciesPanel;

public class DependenciesUtil {
  public DependenciesUtil() {
  }

  public static SearchResults analyzeDependencies(SModule from, SModule to, Project project, MPSProject mpsProject, boolean openTool) {
    DependencyViewerScope fromScope = new DependencyViewerScope();
    fromScope.add(from);
    DependencyViewerScope toScope = new DependencyViewerScope();
    toScope.add(to);

    AnalyzeDependencies_Tool tool = project.getComponent(ProjectPluginManager.class).getTool(AnalyzeDependencies_Tool.class);
    DependenciesPanel panel = as_ehks51_a0a6a1(tool.getComponent(), DependenciesPanel.class);
    panel.resetContent(fromScope, mpsProject, false);
    panel.selectInTargetsView(to);
    if (openTool) {
      tool.openToolLater(true);
    }
    return panel.updateReferencesView(toScope);
  }

  private static <T> T as_ehks51_a0a6a1(Object o, Class<T> type) {
    return (type.isInstance(o) ?
      (T) o :
      null
    );
  }
}
