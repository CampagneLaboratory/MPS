package jetbrains.mps.workbench.dialogs.project.components.parts.creators;

/*Generated by MPS */

import jetbrains.mps.util.Computable;
import java.util.List;
import jetbrains.mps.smodel.SModelReference;
import jetbrains.mps.workbench.dialogs.project.IBindedDialog;
import jetbrains.mps.smodel.ModelAccess;
import jetbrains.mps.smodel.SModelDescriptor;
import jetbrains.mps.FilteredGlobalScope;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.internal.collections.runtime.ISelector;
import jetbrains.mps.workbench.dialogs.choosers.CommonChoosers;

public class ModelChooser implements Computable<List<SModelReference>> {
  private final IBindedDialog myOwner;

  public ModelChooser(IBindedDialog owner) {
    myOwner = owner;
  }

  public List<SModelReference> compute() {
    List<SModelReference> models = ModelAccess.instance().runReadAction(new Computable<List<SModelReference>>() {
      public List<SModelReference> compute() {
        Iterable<SModelDescriptor> descriptors = new FilteredGlobalScope().getModelDescriptors();
        return Sequence.fromIterable(descriptors).select(new ISelector<SModelDescriptor, SModelReference>() {
          public SModelReference select(SModelDescriptor it) {
            return it.getSModelReference();
          }
        }).toListSequence();
      }
    });
    return CommonChoosers.showDialogModelCollectionChooser(null, myOwner.getMainComponent(), models, null);
  }
}
