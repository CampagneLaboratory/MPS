package jetbrains.mps.workbench.dialogs.project.components.parts.lists;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SModelReference;
import jetbrains.mps.smodel.SModelStereotype;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.smodel.SModelRepository;
import jetbrains.mps.util.EqualUtil;
import org.jetbrains.mps.openapi.module.SModuleReference;
import org.jetbrains.mps.openapi.module.SModule;
import jetbrains.mps.smodel.MPSModuleRepository;
import jetbrains.mps.ide.ui.dialogs.properties.StateUtil;
import jetbrains.mps.project.structure.model.ModelRootDescriptor;
import jetbrains.mps.project.structure.modules.Dependency;
import jetbrains.mps.project.structure.project.Path;
import java.util.List;
import org.jdesktop.observablecollections.ObservableCollections;
import java.util.Comparator;

public final class ListsFactory {
  public static final ListsFactory.ListComparator<SModelReference> MODEL_REF_COMPARATOR = new ListsFactory.ListComparator<SModelReference>() {
    @Override
    public int compare(SModelReference o1, SModelReference o2) {
      int compareStereotypes = SModelStereotype.getStereotype(o1.getModelName()).compareTo(SModelStereotype.getStereotype(o2.getModelName()));
      if (compareStereotypes != 0) {
        return compareStereotypes;
      }
      return SModelStereotype.withoutStereotype(o1.getModelName()).compareTo(SModelStereotype.withoutStereotype(o2.getModelName()));
    }

    @Override
    public boolean isEqual(SModelReference o1, SModelReference o2) {
      if (super.isEqual(o1, o2)) {
        return true;
      }
      SModel m1 = SModelRepository.getInstance().getModelDescriptor(o1);
      SModel m2 = SModelRepository.getInstance().getModelDescriptor(o2);
      return EqualUtil.equals(m1, m2);
    }
  };
  public static final ListsFactory.ListComparator<SModuleReference> MODULE_REF_COMPARATOR = new ListsFactory.ListComparator<SModuleReference>() {
    @Override
    public int compare(SModuleReference o1, SModuleReference o2) {
      return o1.getModuleName().compareTo(o2.getModuleName());
    }

    @Override
    public boolean isEqual(SModuleReference o1, SModuleReference o2) {
      if (super.isEqual(o1, o2)) {
        return true;
      }
      SModule m1 = MPSModuleRepository.getInstance().getModule(o1);
      SModule m2 = MPSModuleRepository.getInstance().getModule(o2);
      return EqualUtil.equals(m1, m2);
    }
  };
  public static final ListsFactory.ListComparator<SModuleReference> MODULE_VALID_REF_COMPARATOR = new ListsFactory.ListComparator<SModuleReference>() {
    @Override
    public int compare(SModuleReference o1, SModuleReference o2) {
      int result = StateUtil.compare(o1, o2);
      if (result != 0) {
        return result;
      }
      return ListsFactory.MODULE_REF_COMPARATOR.compare(o1, o2);
    }

    @Override
    public boolean isEqual(SModuleReference o1, SModuleReference o2) {
      return ListsFactory.MODULE_REF_COMPARATOR.isEqual(o1, o2);
    }
  };
  public static final ListsFactory.ListComparator<ModelRootDescriptor> MODEL_ROOT_COMPARATOR = new ListsFactory.ListComparator<ModelRootDescriptor>() {
    @Override
    public int compare(ModelRootDescriptor o1, ModelRootDescriptor o2) {
      return 0;
    }
  };
  public static final ListsFactory.ListComparator<Dependency> DEPENDENCY_COMPARATOR = new ListsFactory.ListComparator<Dependency>() {
    @Override
    public int compare(Dependency o1, Dependency o2) {
      return o1.getModuleRef().getModuleName().compareTo(o2.getModuleRef().getModuleName());
    }

    @Override
    public boolean isEqual(Dependency o1, Dependency o2) {
      if (super.isEqual(o1, o2)) {
        return true;
      }
      SModule m1 = MPSModuleRepository.getInstance().getModule(o1.getModuleRef());
      SModule m2 = MPSModuleRepository.getInstance().getModule(o2.getModuleRef());
      return EqualUtil.equals(m1, m2);
    }
  };
  public static final ListsFactory.ListComparator<Path> PATH_COMPARATOR = new ListsFactory.ListComparator<Path>() {
    private String getPathString(Path path) {
      return ((path == null) ? "null" : path.getPath() + "#" + path.getMPSFolder());
    }

    @Override
    public int compare(Path o1, Path o2) {
      if (o1 == o2) {
        return 0;
      }
      String string1 = getPathString(o1);
      String string2 = getPathString(o2);
      return string1.compareTo(string2);
    }
  };
  public static final ListsFactory.ListComparator<Path> PATH_VALID_COMPARATOR = new ListsFactory.ListComparator<Path>() {
    @Override
    public int compare(Path o1, Path o2) {
      int result = StateUtil.compare(o1.getPath(), o2.getPath());
      if (result != 0) {
        return result;
      }
      return ListsFactory.PATH_COMPARATOR.compare(o1, o2);
    }
  };

  public ListsFactory() {
  }

  public static <T> List<T> createSortedList(ListsFactory.ListComparator<T> comparator) {
    return new SortedList<T>(comparator);
  }

  public static <T> List<T> create(ListsFactory.ListComparator<T> comparator) {
    return ObservableCollections.observableList(ListsFactory.createSortedList(comparator));
  }

  public static abstract class ListComparator<T> implements Comparator<T> {
    public ListComparator() {
    }

    public boolean isEqual(T o1, T o2) {
      return EqualUtil.equals(o1, o2);
    }
  }
}
