package jetbrains.mps.workbench.dialogs.project.components.parts.validators;

/*Generated by MPS */

import jetbrains.mps.smodel.IScope;
import org.jetbrains.mps.openapi.model.SModelReference;
import jetbrains.mps.smodel.ModelAccess;
import jetbrains.mps.util.Computable;

public class ModelValidator implements Validator {
  private IScope myModuleScope;

  public ModelValidator(IScope moduleScope) {
    myModuleScope = moduleScope;
  }

  @Override
  public boolean isBrokenValue(Object value) {
    if (!((value instanceof SModelReference))) {
      return true;
    }
    final SModelReference modelReference = (jetbrains.mps.smodel.SModelReference) value;
    if (myModuleScope == null) {
      return true;
    }
    return ModelAccess.instance().runReadAction(new Computable<Boolean>() {
      @Override
      public Boolean compute() {
        return myModuleScope.getModelDescriptor(modelReference) == null;
      }
    });
  }
}
