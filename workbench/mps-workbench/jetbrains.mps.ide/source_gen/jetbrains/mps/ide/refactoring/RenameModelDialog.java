package jetbrains.mps.ide.refactoring;

/*Generated by MPS */

import jetbrains.mps.ide.platform.refactoring.RenameDialog;
import com.intellij.openapi.project.Project;
import org.jetbrains.mps.openapi.model.EditableSModel;
import java.awt.HeadlessException;
import javax.lang.model.SourceVersion;
import jetbrains.mps.smodel.SModelStereotype;
import jetbrains.mps.smodel.ModelAccess;
import jetbrains.mps.refactoring.Renamer;

public class RenameModelDialog extends RenameDialog {
  private Project myProject;
  private jetbrains.mps.project.Project myMpsProject;
  private EditableSModel myModelDescriptor;
  public RenameModelDialog(Project project, EditableSModel sm, jetbrains.mps.project.Project mpsProject) throws HeadlessException {
    super(project, sm.getModelName(), "model");
    myProject = project;
    myMpsProject = mpsProject;
    myModelDescriptor = sm;
    setTitle("Rename Model");
  }
  @Override
  protected void doRefactoringAction() {
    final String newModelName = getCurrentValue();
    if (!((SourceVersion.isName(SModelStereotype.withoutStereotype(newModelName))))) {
      setErrorText("Model name should be valid Java package");
      return;
    }
    if (!((newModelName.equals(myModelDescriptor.getModelName())))) {
      ModelAccess.instance().runWriteActionInCommand(new Runnable() {
        public void run() {
          Renamer.renameModel(myModelDescriptor, newModelName);
        }
      });
    }

    super.doRefactoringAction();
  }
}
