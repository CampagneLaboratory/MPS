package jetbrains.mps.ide.refactoring;

/*Generated by MPS */

import jetbrains.mps.ide.platform.refactoring.RenameDialog;
import jetbrains.mps.project.MPSProject;
import org.jetbrains.mps.openapi.model.EditableSModel;
import java.awt.HeadlessException;
import javax.lang.model.SourceVersion;
import jetbrains.mps.smodel.SModelStereotype;
import jetbrains.mps.refactoring.Renamer;

public class RenameModelDialog extends RenameDialog {
  private final MPSProject myProject;
  private final EditableSModel myModelDescriptor;

  public RenameModelDialog(MPSProject mpsProject, EditableSModel sm) throws HeadlessException {
    super(mpsProject.getProject(), sm.getModelName(), "model");
    myProject = mpsProject;
    myModelDescriptor = sm;
    setTitle("Rename Model");
  }

  @Override
  protected void doRefactoringAction() {
    final String newModelName = getCurrentValue();
    if (!((SourceVersion.isName(SModelStereotype.withoutStereotype(newModelName))))) {
      setErrorText("Model name should be valid Java package");
      return;
    }
    if (!((newModelName.equals(myModelDescriptor.getModelName())))) {
      myProject.getRepository().getModelAccess().executeCommand(new Runnable() {
        public void run() {
          Renamer.renameModel(myModelDescriptor, newModelName);
        }
      });
    }
    super.doRefactoringAction();
  }
}
