package jetbrains.mps.ide.platform.actions.core;

/*Generated by MPS */

import org.jetbrains.mps.openapi.module.SRepository;
import org.jetbrains.mps.openapi.module.SearchScope;
import jetbrains.mps.ide.findusages.model.SearchResults;
import org.jetbrains.mps.openapi.model.SNode;

public interface RefactoringParticipant<InitialDataObject, FinalDataObject> {

  public String getId();
  public String getDescription();

  public Iterable<RefactoringParticipant.Change<InitialDataObject, FinalDataObject>> getChanges(InitialDataObject initialState, SRepository repository, SearchScope searchScope);

  public static interface Change<InitialDataObject, FinalDataObject> {
    public SearchResults getSearchResults();
    public boolean needsToPreserveOldNode();
    public void confirm(FinalDataObject finalState, SRepository repository, RefactoringSession refactoringSession);
  }

  public SNode serializeInitialState(InitialDataObject initialState);
  public InitialDataObject deserializeInitialState(SNode serialized);
  public SNode serializeFinalState(FinalDataObject finalState);
  public FinalDataObject deserializeFinalState(SNode serialized);

  public static interface ParticipantChanges<I, F> {
    public RefactoringParticipant<I, F> getParticipant();
    public I getInitialState();
    public Iterable<RefactoringParticipant.Change<I, F>> getChanges();
  }

}
