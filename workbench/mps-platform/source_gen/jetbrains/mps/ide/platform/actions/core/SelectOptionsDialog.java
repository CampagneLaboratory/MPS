package jetbrains.mps.ide.platform.actions.core;

/*Generated by MPS */

import jetbrains.mps.ide.platform.refactoring.RefactoringDialog;
import java.util.List;
import javax.swing.JCheckBox;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import java.util.Map;
import com.intellij.openapi.project.Project;
import javax.swing.JComponent;
import javax.swing.JPanel;
import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;
import java.awt.Insets;
import javax.swing.JLabel;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import java.util.HashMap;
import java.util.Iterator;

public class SelectOptionsDialog extends RefactoringDialog {

  private List<String> myOptions;
  private List<JCheckBox> myCheckBoxes = ListSequence.fromList(new ArrayList<JCheckBox>());
  private Map<String, Boolean> mySelected;
  public SelectOptionsDialog(Project project, List<String> options, String title) {
    super(project, true);
    myOptions = options;
    init();
    setTitle(title);
  }
  @Override
  protected JComponent createCenterPanel() {
    JPanel panel = new JPanel(new GridBagLayout());
    int i = 0;

    {
      GridBagConstraints c = new GridBagConstraints();
      c.fill = GridBagConstraints.BOTH;
      c.insets = new Insets(3, 3, 3, 3);
      c.gridx = 0;
      c.gridy = i++;
      c.weightx = 1;
      c.weighty = 1;

      panel.add(new JLabel("Select how update the nodes usages:"), c);

    }

    for (String option : myOptions) {
      GridBagConstraints c = new GridBagConstraints();
      c.fill = GridBagConstraints.BOTH;
      c.insets = new Insets(3, 3, 3, 3);
      c.gridx = 0;
      c.gridy = i++;
      c.weightx = 1;
      c.weighty = 1;

      JCheckBox checkBox = new JCheckBox(option, true);
      ListSequence.fromList(myCheckBoxes).addElement(checkBox);
      panel.add(checkBox, c);
    }
    return panel;
  }
  @Override
  protected void doRefactoringAction() {
    mySelected = MapSequence.fromMap(new HashMap<String, Boolean>());
    {
      Iterator<String> option_it = ListSequence.fromList(myOptions).iterator();
      Iterator<JCheckBox> checkBox_it = ListSequence.fromList(myCheckBoxes).iterator();
      String option_var;
      JCheckBox checkBox_var;
      while (option_it.hasNext() && checkBox_it.hasNext()) {
        option_var = option_it.next();
        checkBox_var = checkBox_it.next();
        MapSequence.fromMap(mySelected).put(option_var, checkBox_var.isSelected());
      }
    }
    super.doRefactoringAction();
  }
  public static Map<String, Boolean> selectOptions(Project project, List<String> options, String title) {
    SelectOptionsDialog dialog = new SelectOptionsDialog(project, options, title);
    dialog.show();
    return dialog.mySelected;
  }

}
