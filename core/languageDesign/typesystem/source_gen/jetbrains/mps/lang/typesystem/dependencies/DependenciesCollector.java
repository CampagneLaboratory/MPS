package jetbrains.mps.lang.typesystem.dependencies;

/*Generated by MPS */

import jetbrains.mps.smodel.SNode;
import java.util.Map;
import jetbrains.mps.util.Pair;
import java.util.Set;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import java.util.HashSet;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import jetbrains.mps.smodel.SModelUtil_new;
import java.util.List;
import jetbrains.mps.util.CollectionUtil;
import jetbrains.mps.util.Condition;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.typesystem.inference.TypeChecker;
import jetbrains.mps.project.GlobalScope;

public class DependenciesCollector {
  public DependenciesCollector() {
  }

  public void collectDependencies(SNode inferenceRule, Map<SNode, Pair<SNode, SNode>> dependencies, Set<SNode> leaves) {
    Set<SNode> roots = SetSequence.fromSet(new HashSet<SNode>());
    for (SNode applicableNodeReference : SNodeOperations.getDescendants(inferenceRule, "jetbrains.mps.lang.typesystem.structure.ApplicableNodeReference", false, new String[]{})) {
      if (SLinkOperations.getTarget(applicableNodeReference, "applicableNode", false) == SLinkOperations.getTarget(inferenceRule, "applicableNode", true)) {
        SetSequence.fromSet(roots).addElement(applicableNodeReference);
      }
    }
    int prevSize = SetSequence.fromSet(MapSequence.fromMap(dependencies).keySet()).count();
    int leavesSize = SetSequence.fromSet(leaves).count();
    for (SNode root : roots) {
      MapSequence.fromMap(dependencies).put(root, null);
    }
    while (SetSequence.fromSet(MapSequence.fromMap(dependencies).keySet()).count() > prevSize || SetSequence.fromSet(leaves).count() > leavesSize) {
      prevSize = SetSequence.fromSet(MapSequence.fromMap(dependencies).keySet()).count();
      leavesSize = SetSequence.fromSet(leaves).count();
      for (SNode node : SetSequence.fromSetWithValues(new HashSet<SNode>(), MapSequence.fromMap(dependencies).keySet())) {
        SNode parent = SNodeOperations.getParent(node);
        do {
          SNode matchedNode_3860_f8rhjlpb = parent;
          {
            boolean matches_3860_f8rhjlpd = false;
            {
              SNode matchingNode_3860_f8rhjlpd = parent;
              if (matchingNode_3860_f8rhjlpd != null) {
                matches_3860_f8rhjlpd = SModelUtil_new.isAssignableConcept(matchingNode_3860_f8rhjlpd.getConceptFqName(), "jetbrains.mps.lang.typesystem.structure.TypeOfExpression");
              }
            }
            if (matches_3860_f8rhjlpd) {
              if (!(SetSequence.fromSet(roots).contains(node))) {
                SetSequence.fromSet(leaves).addElement(node);
              }
              break;
            }
          }
          {
            boolean matches_3860_f8rhm8cu = false;
            {
              SNode matchingNode_3860_f8rhm8cu = parent;
              if (matchingNode_3860_f8rhm8cu != null) {
                matches_3860_f8rhm8cu = SModelUtil_new.isAssignableConcept(matchingNode_3860_f8rhm8cu.getConceptFqName(), "jetbrains.mps.baseLanguage.structure.AssignmentExpression");
              }
            }
            if (matches_3860_f8rhm8cu) {
              if (SLinkOperations.getTarget(matchedNode_3860_f8rhjlpb, "rValue", true) == node) {
                MapSequence.fromMap(dependencies).put(SLinkOperations.getTarget(matchedNode_3860_f8rhjlpb, "lValue", true), new Pair<SNode, SNode>(node, new DependenciesCollector.QuotationClass_3860_l523emnfaouv().createNode()));
              }
              break;
            }
          }
          {
            boolean matches_3860_f8yj0tuh = false;
            {
              SNode matchingNode_3860_f8yj0tuh = parent;
              if (matchingNode_3860_f8yj0tuh != null) {
                matches_3860_f8yj0tuh = SModelUtil_new.isAssignableConcept(matchingNode_3860_f8yj0tuh.getConceptFqName(), "jetbrains.mps.baseLanguage.structure.VariableDeclaration");
              }
            }
            if (matches_3860_f8yj0tuh) {
              if (SLinkOperations.getTarget(matchedNode_3860_f8rhjlpb, "initializer", true) == node) {
                MapSequence.fromMap(dependencies).put(matchedNode_3860_f8rhjlpb, new Pair<SNode, SNode>(node, new DependenciesCollector.QuotationClass_3860_l523emnfap4b().createNode()));
              }
              break;
            }
          }
          do {
            SNode matchedNode_3860_f8ykh1c5 = node;
            {
              boolean matches_3860_f8ykh1c7 = false;
              {
                SNode matchingNode_3860_f8ykh1c7 = node;
                if (matchingNode_3860_f8ykh1c7 != null) {
                  matches_3860_f8ykh1c7 = SModelUtil_new.isAssignableConcept(matchingNode_3860_f8ykh1c7.getConceptFqName(), "jetbrains.mps.baseLanguage.structure.VariableDeclaration");
                }
              }
              if (matches_3860_f8ykh1c7) {
                for (SNode variableReference : SNodeOperations.getDescendants(inferenceRule, "jetbrains.mps.baseLanguage.structure.VariableReference", false, new String[]{})) {
                  if (SLinkOperations.getTarget(variableReference, "variableDeclaration", false) == node) {
                    MapSequence.fromMap(dependencies).put(variableReference, new Pair<SNode, SNode>(node, new DependenciesCollector.QuotationClass_3860_l523emnfapdr().createNode()));
                  }
                }
                break;
              }
            }
            {
              boolean matches_3860_f8yki64r = false;
              {
                SNode matchingNode_3860_f8yki64r = node;
                if (matchingNode_3860_f8yki64r != null) {
                  matches_3860_f8yki64r = SModelUtil_new.isAssignableConcept(matchingNode_3860_f8yki64r.getConceptFqName(), "jetbrains.mps.baseLanguage.structure.VariableReference");
                }
              }
              if (matches_3860_f8yki64r) {
                {
                  SNode variableDeclaration = SLinkOperations.getTarget(matchedNode_3860_f8ykh1c5, "variableDeclaration", false);
                  for (SNode reference : SNodeOperations.getDescendants(inferenceRule, "jetbrains.mps.baseLanguage.structure.VariableReference", false, new String[]{})) {
                    if (SLinkOperations.getTarget(matchedNode_3860_f8ykh1c5, "variableDeclaration", false) == variableDeclaration) {
                      SNode nodeStatement = SNodeOperations.getAncestor(matchedNode_3860_f8ykh1c5, "jetbrains.mps.baseLanguage.structure.Statement", false, false);
                      SNode usageStatement = SNodeOperations.getAncestor(reference, "jetbrains.mps.baseLanguage.structure.Statement", false, false);
                      while (SNodeOperations.getParent(nodeStatement) != SNodeOperations.getParent(usageStatement)) {
                        usageStatement = SNodeOperations.getAncestor(usageStatement, "jetbrains.mps.baseLanguage.structure.Statement", false, false);
                      }
                      List<SNode> list = CollectionUtil.filter(SNodeOperations.getParent(nodeStatement).getChildren(), new Condition() {
                        public boolean met(Object p0) {
                          return SNodeOperations.isInstanceOf(((SNode) p0), "jetbrains.mps.baseLanguage.structure.Statement");
                        }
                      });
                      if (ListSequence.fromList(list).indexOf(nodeStatement) <= ListSequence.fromList(list).indexOf(usageStatement)) {
                        MapSequence.fromMap(dependencies).put(reference, new Pair<SNode, SNode>(node, new DependenciesCollector.QuotationClass_3860_l523emnfapn9().createNode()));
                      }
                    }
                  }
                }
                break;
              }
            }
          } while(false);
        } while(false);
      }
    }
  }

  public static class QuotationClass_3860_l523emnfaouv {
    public QuotationClass_3860_l523emnfaouv() {
    }

    public SNode createNode() {
      SNode result = null;
      Set<SNode> _parameterValues_129834374 = new HashSet<SNode>();
      SNode quotedNode_3860_l523emnfangm = null;
      SNode quotedNode_3860_l523emnfangn = null;
      SNode quotedNode_3860_l523emnfango = null;
      SNode quotedNode_3860_l523emnfangp = null;
      SNode quotedNode_3860_l523emnfangr = null;
      SNode quotedNode_3860_l523emnfangq = null;
      SNode quotedNode_3860_l523emnfangs = null;
      SNode quotedNode_3860_l523emnfangt = null;
      SNode quotedNode_3860_l523emnfangu = null;
      SNode quotedNode_3860_l523emnfangv = null;
      {
        quotedNode_3860_l523emnfangm = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.InstanceMethodDeclaration", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
        SNode quotedNode1_3860_l523emnfangm = quotedNode_3860_l523emnfangm;
        quotedNode1_3860_l523emnfangm.setProperty("name", "getNode");
        {
          quotedNode_3860_l523emnfangn = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.PublicVisibility", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfangn = quotedNode_3860_l523emnfangn;
          quotedNode_3860_l523emnfangm.addChild("visibility", quotedNode1_3860_l523emnfangn);
        }
        {
          quotedNode_3860_l523emnfango = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.VoidType", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfango = quotedNode_3860_l523emnfango;
          quotedNode_3860_l523emnfangm.addChild("returnType", quotedNode1_3860_l523emnfango);
        }
        {
          quotedNode_3860_l523emnfangp = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterDeclaration", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfangp = quotedNode_3860_l523emnfangp;
          quotedNode1_3860_l523emnfangp.setProperty("name", "targetNode");
          {
            quotedNode_3860_l523emnfangq = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.lang.smodel.structure.SNodeType", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
            SNode quotedNode1_3860_l523emnfangq = quotedNode_3860_l523emnfangq;
            quotedNode_3860_l523emnfangp.addChild("type", quotedNode1_3860_l523emnfangq);
          }
          quotedNode_3860_l523emnfangm.addChild("parameter", quotedNode1_3860_l523emnfangp);
        }
        {
          quotedNode_3860_l523emnfangr = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.StatementList", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfangr = quotedNode_3860_l523emnfangr;
          {
            quotedNode_3860_l523emnfangs = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ExpressionStatement", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
            SNode quotedNode1_3860_l523emnfangs = quotedNode_3860_l523emnfangs;
            {
              quotedNode_3860_l523emnfangt = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.AssignmentExpression", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
              SNode quotedNode1_3860_l523emnfangt = quotedNode_3860_l523emnfangt;
              {
                quotedNode_3860_l523emnfangu = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterReference", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
                SNode quotedNode1_3860_l523emnfangu = quotedNode_3860_l523emnfangu;
                quotedNode_3860_l523emnfangt.addChild("lValue", quotedNode1_3860_l523emnfangu);
              }
              {
                quotedNode_3860_l523emnfangv = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterReference", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
                SNode quotedNode1_3860_l523emnfangv = quotedNode_3860_l523emnfangv;
                quotedNode_3860_l523emnfangt.addChild("rValue", quotedNode1_3860_l523emnfangv);
              }
              quotedNode_3860_l523emnfangs.addChild("expression", quotedNode1_3860_l523emnfangt);
            }
            quotedNode_3860_l523emnfangr.addChild("statement", quotedNode1_3860_l523emnfangs);
          }
          quotedNode_3860_l523emnfangm.addChild("body", quotedNode1_3860_l523emnfangr);
        }
        result = quotedNode1_3860_l523emnfangm;
      }
      quotedNode_3860_l523emnfangu.setReferent("variableDeclaration", quotedNode_3860_l523emnfangp);
      quotedNode_3860_l523emnfangv.setReferent("variableDeclaration", quotedNode_3860_l523emnfangp);
      return result;
    }
  }

  public static class QuotationClass_3860_l523emnfap4b {
    public QuotationClass_3860_l523emnfap4b() {
    }

    public SNode createNode() {
      SNode result = null;
      Set<SNode> _parameterValues_129834374 = new HashSet<SNode>();
      SNode quotedNode_3860_l523emnfanhi = null;
      SNode quotedNode_3860_l523emnfanhj = null;
      SNode quotedNode_3860_l523emnfanhk = null;
      SNode quotedNode_3860_l523emnfanhl = null;
      SNode quotedNode_3860_l523emnfanhn = null;
      SNode quotedNode_3860_l523emnfanhm = null;
      SNode quotedNode_3860_l523emnfanho = null;
      SNode quotedNode_3860_l523emnfanhp = null;
      SNode quotedNode_3860_l523emnfanhq = null;
      SNode quotedNode_3860_l523emnfanhr = null;
      {
        quotedNode_3860_l523emnfanhi = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.InstanceMethodDeclaration", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
        SNode quotedNode1_3860_l523emnfanhi = quotedNode_3860_l523emnfanhi;
        quotedNode1_3860_l523emnfanhi.setProperty("name", "getNode");
        {
          quotedNode_3860_l523emnfanhj = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.PublicVisibility", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanhj = quotedNode_3860_l523emnfanhj;
          quotedNode_3860_l523emnfanhi.addChild("visibility", quotedNode1_3860_l523emnfanhj);
        }
        {
          quotedNode_3860_l523emnfanhk = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.VoidType", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanhk = quotedNode_3860_l523emnfanhk;
          quotedNode_3860_l523emnfanhi.addChild("returnType", quotedNode1_3860_l523emnfanhk);
        }
        {
          quotedNode_3860_l523emnfanhl = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterDeclaration", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanhl = quotedNode_3860_l523emnfanhl;
          quotedNode1_3860_l523emnfanhl.setProperty("name", "targetNode");
          {
            quotedNode_3860_l523emnfanhm = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.lang.smodel.structure.SNodeType", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
            SNode quotedNode1_3860_l523emnfanhm = quotedNode_3860_l523emnfanhm;
            quotedNode_3860_l523emnfanhl.addChild("type", quotedNode1_3860_l523emnfanhm);
          }
          quotedNode_3860_l523emnfanhi.addChild("parameter", quotedNode1_3860_l523emnfanhl);
        }
        {
          quotedNode_3860_l523emnfanhn = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.StatementList", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanhn = quotedNode_3860_l523emnfanhn;
          {
            quotedNode_3860_l523emnfanho = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ExpressionStatement", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
            SNode quotedNode1_3860_l523emnfanho = quotedNode_3860_l523emnfanho;
            {
              quotedNode_3860_l523emnfanhp = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.AssignmentExpression", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
              SNode quotedNode1_3860_l523emnfanhp = quotedNode_3860_l523emnfanhp;
              {
                quotedNode_3860_l523emnfanhq = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterReference", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
                SNode quotedNode1_3860_l523emnfanhq = quotedNode_3860_l523emnfanhq;
                quotedNode_3860_l523emnfanhp.addChild("lValue", quotedNode1_3860_l523emnfanhq);
              }
              {
                quotedNode_3860_l523emnfanhr = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterReference", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
                SNode quotedNode1_3860_l523emnfanhr = quotedNode_3860_l523emnfanhr;
                quotedNode_3860_l523emnfanhp.addChild("rValue", quotedNode1_3860_l523emnfanhr);
              }
              quotedNode_3860_l523emnfanho.addChild("expression", quotedNode1_3860_l523emnfanhp);
            }
            quotedNode_3860_l523emnfanhn.addChild("statement", quotedNode1_3860_l523emnfanho);
          }
          quotedNode_3860_l523emnfanhi.addChild("body", quotedNode1_3860_l523emnfanhn);
        }
        result = quotedNode1_3860_l523emnfanhi;
      }
      quotedNode_3860_l523emnfanhq.setReferent("variableDeclaration", quotedNode_3860_l523emnfanhl);
      quotedNode_3860_l523emnfanhr.setReferent("variableDeclaration", quotedNode_3860_l523emnfanhl);
      return result;
    }
  }

  public static class QuotationClass_3860_l523emnfapdr {
    public QuotationClass_3860_l523emnfapdr() {
    }

    public SNode createNode() {
      SNode result = null;
      Set<SNode> _parameterValues_129834374 = new HashSet<SNode>();
      SNode quotedNode_3860_l523emnfania = null;
      SNode quotedNode_3860_l523emnfanib = null;
      SNode quotedNode_3860_l523emnfanic = null;
      SNode quotedNode_3860_l523emnfanid = null;
      SNode quotedNode_3860_l523emnfanif = null;
      SNode quotedNode_3860_l523emnfanie = null;
      SNode quotedNode_3860_l523emnfanig = null;
      SNode quotedNode_3860_l523emnfanih = null;
      SNode quotedNode_3860_l523emnfanii = null;
      SNode quotedNode_3860_l523emnfanij = null;
      {
        quotedNode_3860_l523emnfania = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.InstanceMethodDeclaration", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
        SNode quotedNode1_3860_l523emnfania = quotedNode_3860_l523emnfania;
        quotedNode1_3860_l523emnfania.setProperty("name", "getNode");
        {
          quotedNode_3860_l523emnfanib = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.PublicVisibility", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanib = quotedNode_3860_l523emnfanib;
          quotedNode_3860_l523emnfania.addChild("visibility", quotedNode1_3860_l523emnfanib);
        }
        {
          quotedNode_3860_l523emnfanic = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.VoidType", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanic = quotedNode_3860_l523emnfanic;
          quotedNode_3860_l523emnfania.addChild("returnType", quotedNode1_3860_l523emnfanic);
        }
        {
          quotedNode_3860_l523emnfanid = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterDeclaration", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanid = quotedNode_3860_l523emnfanid;
          quotedNode1_3860_l523emnfanid.setProperty("name", "targetNode");
          {
            quotedNode_3860_l523emnfanie = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.lang.smodel.structure.SNodeType", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
            SNode quotedNode1_3860_l523emnfanie = quotedNode_3860_l523emnfanie;
            quotedNode_3860_l523emnfanid.addChild("type", quotedNode1_3860_l523emnfanie);
          }
          quotedNode_3860_l523emnfania.addChild("parameter", quotedNode1_3860_l523emnfanid);
        }
        {
          quotedNode_3860_l523emnfanif = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.StatementList", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanif = quotedNode_3860_l523emnfanif;
          {
            quotedNode_3860_l523emnfanig = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ExpressionStatement", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
            SNode quotedNode1_3860_l523emnfanig = quotedNode_3860_l523emnfanig;
            {
              quotedNode_3860_l523emnfanih = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.AssignmentExpression", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
              SNode quotedNode1_3860_l523emnfanih = quotedNode_3860_l523emnfanih;
              {
                quotedNode_3860_l523emnfanii = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterReference", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
                SNode quotedNode1_3860_l523emnfanii = quotedNode_3860_l523emnfanii;
                quotedNode_3860_l523emnfanih.addChild("lValue", quotedNode1_3860_l523emnfanii);
              }
              {
                quotedNode_3860_l523emnfanij = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterReference", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
                SNode quotedNode1_3860_l523emnfanij = quotedNode_3860_l523emnfanij;
                quotedNode_3860_l523emnfanih.addChild("rValue", quotedNode1_3860_l523emnfanij);
              }
              quotedNode_3860_l523emnfanig.addChild("expression", quotedNode1_3860_l523emnfanih);
            }
            quotedNode_3860_l523emnfanif.addChild("statement", quotedNode1_3860_l523emnfanig);
          }
          quotedNode_3860_l523emnfania.addChild("body", quotedNode1_3860_l523emnfanif);
        }
        result = quotedNode1_3860_l523emnfania;
      }
      quotedNode_3860_l523emnfanii.setReferent("variableDeclaration", quotedNode_3860_l523emnfanid);
      quotedNode_3860_l523emnfanij.setReferent("variableDeclaration", quotedNode_3860_l523emnfanid);
      return result;
    }
  }

  public static class QuotationClass_3860_l523emnfapn9 {
    public QuotationClass_3860_l523emnfapn9() {
    }

    public SNode createNode() {
      SNode result = null;
      Set<SNode> _parameterValues_129834374 = new HashSet<SNode>();
      SNode quotedNode_3860_l523emnfanl9 = null;
      SNode quotedNode_3860_l523emnfanla = null;
      SNode quotedNode_3860_l523emnfanlb = null;
      SNode quotedNode_3860_l523emnfanlc = null;
      SNode quotedNode_3860_l523emnfanle = null;
      SNode quotedNode_3860_l523emnfanld = null;
      SNode quotedNode_3860_l523emnfanlf = null;
      SNode quotedNode_3860_l523emnfanlg = null;
      SNode quotedNode_3860_l523emnfanlh = null;
      SNode quotedNode_3860_l523emnfanli = null;
      {
        quotedNode_3860_l523emnfanl9 = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.InstanceMethodDeclaration", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
        SNode quotedNode1_3860_l523emnfanl9 = quotedNode_3860_l523emnfanl9;
        quotedNode1_3860_l523emnfanl9.setProperty("name", "getNode");
        {
          quotedNode_3860_l523emnfanla = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.PublicVisibility", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanla = quotedNode_3860_l523emnfanla;
          quotedNode_3860_l523emnfanl9.addChild("visibility", quotedNode1_3860_l523emnfanla);
        }
        {
          quotedNode_3860_l523emnfanlb = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.VoidType", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanlb = quotedNode_3860_l523emnfanlb;
          quotedNode_3860_l523emnfanl9.addChild("returnType", quotedNode1_3860_l523emnfanlb);
        }
        {
          quotedNode_3860_l523emnfanlc = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterDeclaration", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanlc = quotedNode_3860_l523emnfanlc;
          quotedNode1_3860_l523emnfanlc.setProperty("name", "targetNode");
          {
            quotedNode_3860_l523emnfanld = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.lang.smodel.structure.SNodeType", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
            SNode quotedNode1_3860_l523emnfanld = quotedNode_3860_l523emnfanld;
            quotedNode_3860_l523emnfanlc.addChild("type", quotedNode1_3860_l523emnfanld);
          }
          quotedNode_3860_l523emnfanl9.addChild("parameter", quotedNode1_3860_l523emnfanlc);
        }
        {
          quotedNode_3860_l523emnfanle = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.StatementList", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
          SNode quotedNode1_3860_l523emnfanle = quotedNode_3860_l523emnfanle;
          {
            quotedNode_3860_l523emnfanlf = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ExpressionStatement", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
            SNode quotedNode1_3860_l523emnfanlf = quotedNode_3860_l523emnfanlf;
            {
              quotedNode_3860_l523emnfanlg = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.AssignmentExpression", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
              SNode quotedNode1_3860_l523emnfanlg = quotedNode_3860_l523emnfanlg;
              {
                quotedNode_3860_l523emnfanlh = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterReference", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
                SNode quotedNode1_3860_l523emnfanlh = quotedNode_3860_l523emnfanlh;
                quotedNode_3860_l523emnfanlg.addChild("lValue", quotedNode1_3860_l523emnfanlh);
              }
              {
                quotedNode_3860_l523emnfanli = SModelUtil_new.instantiateConceptDeclaration("jetbrains.mps.baseLanguage.structure.ParameterReference", TypeChecker.getInstance().getRuntimeTypesModel(), GlobalScope.getInstance(), false);
                SNode quotedNode1_3860_l523emnfanli = quotedNode_3860_l523emnfanli;
                quotedNode_3860_l523emnfanlg.addChild("rValue", quotedNode1_3860_l523emnfanli);
              }
              quotedNode_3860_l523emnfanlf.addChild("expression", quotedNode1_3860_l523emnfanlg);
            }
            quotedNode_3860_l523emnfanle.addChild("statement", quotedNode1_3860_l523emnfanlf);
          }
          quotedNode_3860_l523emnfanl9.addChild("body", quotedNode1_3860_l523emnfanle);
        }
        result = quotedNode1_3860_l523emnfanl9;
      }
      quotedNode_3860_l523emnfanlh.setReferent("variableDeclaration", quotedNode_3860_l523emnfanlc);
      quotedNode_3860_l523emnfanli.setReferent("variableDeclaration", quotedNode_3860_l523emnfanlc);
      return result;
    }
  }
}
