package jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main;

/*Generated by MPS */

import jetbrains.mps.generator.runtime.TemplateMappingConfiguration;
import jetbrains.mps.smodel.SNodePointer;
import java.util.Collection;
import jetbrains.mps.generator.runtime.TemplateReductionRule;
import jetbrains.mps.generator.runtime.TemplateRootMappingRule;
import jetbrains.mps.generator.runtime.TemplateModel;
import jetbrains.mps.generator.runtime.TemplateUtil;
import jetbrains.mps.generator.runtime.TemplateCreateRootRule;
import java.util.Collections;
import jetbrains.mps.generator.runtime.TemplateWeavingRule;
import jetbrains.mps.generator.runtime.TemplateDropRootRule;
import jetbrains.mps.generator.runtime.TemplateMappingScript;
import jetbrains.mps.smodel.SNode;
import jetbrains.mps.generator.runtime.TemplateExecutionEnvironment;
import jetbrains.mps.generator.runtime.TemplateContext;
import jetbrains.mps.generator.runtime.GenerationException;
import jetbrains.mps.generator.template.SourceSubstituteMacroNodeContext;
import jetbrains.mps.generator.template.BaseMappingRuleContext;
import jetbrains.mps.generator.runtime.ReferenceResolver;
import jetbrains.mps.generator.template.ReferenceMacroContext;
import jetbrains.mps.generator.template.PropertyMacroContext;

public class Mappingmain implements TemplateMappingConfiguration {
  private static SNodePointer reductionRule_417xrn_a0a2a = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209604172327");
  private static SNodePointer templateNode_417xrn_a0a0a3a3a = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209604217076");
  private static SNodePointer copySrcMacro_417xrn_a0a0a1a4a3a3a = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209604320454");
  private static SNodePointer reductionRule_417xrn_a0a2b = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "8900764248744322637");
  private static SNodePointer copySrcMacro_417xrn_a0a0a4a3b = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1473665232107485239");
  private static SNodePointer templateNode_417xrn_a0a0a7a3b = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1473665232107455261");
  private static SNodePointer referenceMacro_417xrn_c0b0a0a0a0a0c0h0d1 = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1473665232107455263");
  private static SNodePointer reductionRule_417xrn_a0a2c = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209662301915");
  private static SNodePointer templateNode_417xrn_a0a0a3a3c = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209662301917");
  private static SNodePointer copySrcMacro_417xrn_a0a0a1a4a3a3c = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209662301919");
  private static SNodePointer reductionRule_417xrn_a0a2d = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "2163819695913378077");
  private static SNodePointer templateNode_417xrn_a0a0a3a3d = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "2163819695913379840");
  private static SNodePointer reductionRule_417xrn_a0a2e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198679070");
  private static SNodePointer templateNode_417xrn_a0a0a3a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681233");
  private static SNodePointer templateNode_417xrn_a0a0a1a3a3a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681234");
  private static SNodePointer propertyMacro_417xrn_c0b0b0a2a1a3a3a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681248");
  private static SNodePointer templateNode_417xrn_a0a0a1a4a1a3a3a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681235");
  private static SNodePointer templateNode_417xrn_a0a0a5a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681237");
  private static SNodePointer templateNode_417xrn_a0a0a1a3a5a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681238");
  private static SNodePointer propertyMacro_417xrn_c0b0b0a2a1a3a5a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681257");
  private static SNodePointer templateNode_417xrn_a0a0a1a4a1a3a5a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681239");
  private static SNodePointer templateNode_417xrn_a0a0a1a5a1a3a5a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681242");
  private static SNodePointer templateNode_417xrn_a0a0a1a3a1a5a1a3a5a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681241");
  private static SNodePointer templateNode_417xrn_a0a0a1a4a1a5a1a3a5a3e = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681245");
  private static SNodePointer patternRule_417xrn_a0a0f = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "4146564171992608883");
  private static SNodePointer patternRule_417xrn_a0a0g = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "2681305894288275225");
  private static SNodePointer patternRule_417xrn_a0a0h = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "2681305894288382558");
  private static SNodePointer patternRule_417xrn_a0a0i = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "2681305894288486365");
  private static SNodePointer patternRule_417xrn_a0a0j = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "2163819695913701566");
  private static SNodePointer patternRule_417xrn_a0a0k = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "5857536350883030949");
  private static SNodePointer patternRule_417xrn_a0a0l = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "933643154465852759");
  private static SNodePointer rootMappingRule_417xrn_a0a0m = new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "4146564171992412767");

  private final Collection<TemplateReductionRule> rules;
  private final Collection<TemplateRootMappingRule> rootRules;
  private final TemplateModel myModel;

  public Mappingmain(TemplateModel model) {
    this.myModel = model;
    rules = TemplateUtil.<TemplateReductionRule>asCollection(new Mappingmain.ReductionRule0(), new Mappingmain.ReductionRule1(), new Mappingmain.ReductionRule2(), new Mappingmain.ReductionRule3(), new Mappingmain.ReductionRule4(), new Mappingmain.PatternRule0(), new Mappingmain.PatternRule1(), new Mappingmain.PatternRule2(), new Mappingmain.PatternRule3(), new Mappingmain.PatternRule4(), new Mappingmain.PatternRule5(), new Mappingmain.PatternRule6());
    rootRules = TemplateUtil.<TemplateRootMappingRule>asCollection(new Mappingmain.RootMappingRule0());
  }

  public String getName() {
    return null;
  }

  public TemplateModel getModel() {
    return null;
  }

  public SNodePointer getMappingNode() {
    return new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209603916390");
  }

  public Collection<TemplateReductionRule> getReductionRules() {
    return rules;
  }

  public Collection<TemplateCreateRootRule> getCreateRules() {
    return Collections.emptySet();
  }

  public Collection<TemplateRootMappingRule> getRootRules() {
    return rootRules;
  }

  public Collection<TemplateWeavingRule> getWeavingRules() {
    return Collections.emptySet();
  }

  public Collection<TemplateDropRootRule> getDropRules() {
    return Collections.emptySet();
  }

  public Collection<TemplateMappingScript> getPostScripts() {
    return null;
  }

  public Collection<TemplateMappingScript> getPreScripts() {
    return null;
  }

  public class ReductionRule0 implements TemplateReductionRule {
    public ReductionRule0() {
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.OutputNode_forDontApplyReductionTwice_test";
    }

    public SNodePointer getRuleNode() {
      return reductionRule_417xrn_a0a2a;
    }

    public Collection<SNode> tryToApply(final TemplateExecutionEnvironment environment, final TemplateContext context) throws GenerationException {

      environment.getTracer().pushRuleConsequence(new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209604206699"));
      final SNode tnode1 = new SNode(environment.getOutputModel(), "jetbrains.mps.transformation.test.outputLang.structure.OutputNode", false);
      try {
        environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a3a3a);
        environment.nodeCopied(context, tnode1, "tpl/r:00000000-0000-4000-0000-011c89590606/1209604217076");
        tnode1.setProperty("text", "wrapper created by reduction 1");

        {
          Collection<SNode> tlist2 = null;
          try {
            environment.getTracer().pushMacro(copySrcMacro_417xrn_a0a0a1a4a3a3a);
            final SNode copySrcInput2 = QueriesGenerated.sourceNodeQuery_1209604320455(environment.getOperationContext(), new SourceSubstituteMacroNodeContext(context.getInput(), copySrcMacro_417xrn_a0a0a1a4a3a3a, context, environment.getGenerator()));
            tlist2 = environment.copyNodes(Collections.singletonList(copySrcInput2), copySrcMacro_417xrn_a0a0a1a4a3a3a, null, context);
          } finally {
            environment.getTracer().closeMacro(copySrcMacro_417xrn_a0a0a1a4a3a3a);
          }
          for (SNode child3 : tlist2) {
            tnode1.addChild("outputChild", child3);
          }
          // TODO validate child 
        }
      } finally {
        environment.getTracer().pushOutputNode(tnode1);
        environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a3a3a);
      }
      return TemplateUtil.singletonList(tnode1);
    }
  }

  public class ReductionRule1 implements TemplateReductionRule {
    public ReductionRule1() {
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.OutputNode";
    }

    public SNodePointer getRuleNode() {
      return reductionRule_417xrn_a0a2b;
    }

    public Collection<SNode> tryToApply(final TemplateExecutionEnvironment environment, final TemplateContext context) throws GenerationException {
      if (!(QueriesGenerated.baseMappingRule_Condition_8900764248744322639(environment.getOperationContext(), new BaseMappingRuleContext(context.getInput(), reductionRule_417xrn_a0a2b, environment.getGenerator())))) {
        return null;
      }

      environment.getTracer().pushRuleConsequence(new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "8900764248744322643"));
      Collection<SNode> tlist1 = null;
      try {
        environment.getTracer().pushMacro(copySrcMacro_417xrn_a0a0a4a3b);
        final SNode copySrcInput1 = QueriesGenerated.sourceNodeQuery_1473665232107485240(environment.getOperationContext(), new SourceSubstituteMacroNodeContext(context.getInput(), copySrcMacro_417xrn_a0a0a4a3b, context, environment.getGenerator()));
        tlist1 = environment.copyNodes(Collections.singletonList(copySrcInput1), copySrcMacro_417xrn_a0a0a4a3b, "sd", context);
      } finally {
        environment.getTracer().closeMacro(copySrcMacro_417xrn_a0a0a4a3b);
      }
      TemplateContext context2 = context.subContext("sd");
      final SNode tnode3 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.LocalVariableReference", false);
      try {
        environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a7a3b);
        environment.nodeCopied(context2, tnode3, "tpl/r:00000000-0000-4000-0000-011c89590606/1473665232107455261");
        environment.resolve(new ReferenceResolver() {
          public Object resolve(SNode outputNode, TemplateContext context) {
            return QueriesGenerated.referenceMacro_GetReferent_1473665232107455264(environment.getOperationContext(), new ReferenceMacroContext(context.getInput(), tnode3, referenceMacro_417xrn_c0b0a0a0a0a0c0h0d1, "variableDeclaration", context, environment.getGenerator()));
          }

          public String getDefaultResolveInfo() {
            return "i";
          }

          public SNodePointer getTemplateNode() {
            return new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1473665232107455263");
          }
        }, tnode3, "variableDeclaration", context2);

      } finally {
        environment.getTracer().pushOutputNode(tnode3);
        environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a7a3b);
      }
      Collection<SNode> tlist4 = TemplateUtil.asList(tlist1, tnode3);
      return tlist4;
    }
  }

  public class ReductionRule2 implements TemplateReductionRule {
    public ReductionRule2() {
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.OutputNode_forDontApplyReductionTwice_test";
    }

    public SNodePointer getRuleNode() {
      return reductionRule_417xrn_a0a2c;
    }

    public Collection<SNode> tryToApply(final TemplateExecutionEnvironment environment, final TemplateContext context) throws GenerationException {

      environment.getTracer().pushRuleConsequence(new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "1209662301916"));
      final SNode tnode1 = new SNode(environment.getOutputModel(), "jetbrains.mps.transformation.test.outputLang.structure.OutputNode", false);
      try {
        environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a3a3c);
        environment.nodeCopied(context, tnode1, "tpl/r:00000000-0000-4000-0000-011c89590606/1209662301917");
        tnode1.setProperty("text", "wrapper created by reduction 2");

        {
          Collection<SNode> tlist2 = null;
          try {
            environment.getTracer().pushMacro(copySrcMacro_417xrn_a0a0a1a4a3a3c);
            final SNode copySrcInput2 = QueriesGenerated.sourceNodeQuery_1209662301920(environment.getOperationContext(), new SourceSubstituteMacroNodeContext(context.getInput(), copySrcMacro_417xrn_a0a0a1a4a3a3c, context, environment.getGenerator()));
            tlist2 = environment.copyNodes(Collections.singletonList(copySrcInput2), copySrcMacro_417xrn_a0a0a1a4a3a3c, null, context);
          } finally {
            environment.getTracer().closeMacro(copySrcMacro_417xrn_a0a0a1a4a3a3c);
          }
          for (SNode child3 : tlist2) {
            tnode1.addChild("outputChild", child3);
          }
          // TODO validate child 
        }
      } finally {
        environment.getTracer().pushOutputNode(tnode1);
        environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a3a3c);
      }
      return TemplateUtil.singletonList(tnode1);
    }
  }

  public class ReductionRule3 implements TemplateReductionRule {
    public ReductionRule3() {
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.CustomStatementRef";
    }

    public SNodePointer getRuleNode() {
      return reductionRule_417xrn_a0a2d;
    }

    public Collection<SNode> tryToApply(final TemplateExecutionEnvironment environment, final TemplateContext context) throws GenerationException {

      environment.getTracer().pushRuleConsequence(new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "2163819695913379838"));
      final SNode tnode1 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.IntegerConstant", false);
      try {
        environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a3a3d);
        environment.nodeCopied(context, tnode1, "tpl/r:00000000-0000-4000-0000-011c89590606/2163819695913379840");
        tnode1.setProperty("value", "42");

      } finally {
        environment.getTracer().pushOutputNode(tnode1);
        environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a3a3d);
      }
      return TemplateUtil.singletonList(tnode1);
    }
  }

  public class ReductionRule4 implements TemplateReductionRule {
    public ReductionRule4() {
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.TwoVarStatement";
    }

    public SNodePointer getRuleNode() {
      return reductionRule_417xrn_a0a2e;
    }

    public Collection<SNode> tryToApply(final TemplateExecutionEnvironment environment, final TemplateContext context) throws GenerationException {

      environment.getTracer().pushRuleConsequence(new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681229"));
      final SNode tnode1 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.LocalVariableDeclarationStatement", false);
      try {
        environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a3a3e);
        environment.nodeCopied(context, tnode1, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681233");

        {
          final SNode tnode2 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.LocalVariableDeclaration", false);
          try {
            environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a1a3a3a3e);
            environment.nodeCopied(context, tnode2, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681234");
            tnode2.setProperty("name", (String) QueriesGenerated.propertyMacro_GetPropertyValue_6010543442198681251(environment.getOperationContext(), new PropertyMacroContext(context.getInput(), "i", propertyMacro_417xrn_c0b0b0a2a1a3a3a3e, context, environment.getGenerator())));

            {
              final SNode tnode3 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.IntegerType", false);
              try {
                environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a1a4a1a3a3a3e);
                environment.nodeCopied(context, tnode3, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681235");

              } finally {
                environment.getTracer().pushOutputNode(tnode3);
                environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a1a4a1a3a3a3e);
              }
              tnode2.addChild("type", tnode3);
              // TODO validate child 
            }
          } finally {
            environment.getTracer().pushOutputNode(tnode2);
            environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a1a3a3a3e);
          }
          tnode1.addChild("localVariableDeclaration", tnode2);
          // TODO validate child 
        }
      } finally {
        environment.getTracer().pushOutputNode(tnode1);
        environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a3a3e);
      }
      final SNode tnode4 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.LocalVariableDeclarationStatement", false);
      try {
        environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a5a3e);
        environment.nodeCopied(context, tnode4, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681237");

        {
          final SNode tnode5 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.LocalVariableDeclaration", false);
          try {
            environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a1a3a5a3e);
            environment.nodeCopied(context, tnode5, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681238");
            tnode5.setProperty("name", (String) QueriesGenerated.propertyMacro_GetPropertyValue_6010543442198681260(environment.getOperationContext(), new PropertyMacroContext(context.getInput(), "e", propertyMacro_417xrn_c0b0b0a2a1a3a5a3e, context, environment.getGenerator())));

            {
              final SNode tnode6 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.IntegerType", false);
              try {
                environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a1a4a1a3a5a3e);
                environment.nodeCopied(context, tnode6, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681239");

              } finally {
                environment.getTracer().pushOutputNode(tnode6);
                environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a1a4a1a3a5a3e);
              }
              tnode5.addChild("type", tnode6);
              // TODO validate child 
            }
            {
              final SNode tnode7 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.MulExpression", false);
              try {
                environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a1a5a1a3a5a3e);
                environment.nodeCopied(context, tnode7, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681242");

                {
                  final SNode tnode8 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.LocalVariableReference", false);
                  try {
                    environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a1a3a1a5a1a3a5a3e);
                    environment.nodeCopied(context, tnode8, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681241");
                    environment.resolveInTemplateLater(tnode8, "variableDeclaration", new SNodePointer("r:00000000-0000-4000-0000-011c89590606(jetbrains.mps.transformation.test.outputLang.generator.baseLanguage.template.main@generator)", "6010543442198681241"), "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681234", "i", context);

                  } finally {
                    environment.getTracer().pushOutputNode(tnode8);
                    environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a1a3a1a5a1a3a5a3e);
                  }
                  tnode7.addChild("leftExpression", tnode8);
                  // TODO validate child 
                }
                {
                  final SNode tnode9 = new SNode(environment.getOutputModel(), "jetbrains.mps.baseLanguage.structure.IntegerConstant", false);
                  try {
                    environment.getTracer().pushTemplateNode(templateNode_417xrn_a0a0a1a4a1a5a1a3a5a3e);
                    environment.nodeCopied(context, tnode9, "tpl/r:00000000-0000-4000-0000-011c89590606/6010543442198681245");
                    tnode9.setProperty("value", "2");

                  } finally {
                    environment.getTracer().pushOutputNode(tnode9);
                    environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a1a4a1a5a1a3a5a3e);
                  }
                  tnode7.addChild("rightExpression", tnode9);
                  // TODO validate child 
                }
              } finally {
                environment.getTracer().pushOutputNode(tnode7);
                environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a1a5a1a3a5a3e);
              }
              tnode5.addChild("initializer", tnode7);
              // TODO validate child 
            }
          } finally {
            environment.getTracer().pushOutputNode(tnode5);
            environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a1a3a5a3e);
          }
          tnode4.addChild("localVariableDeclaration", tnode5);
          // TODO validate child 
        }
      } finally {
        environment.getTracer().pushOutputNode(tnode4);
        environment.getTracer().closeTemplateNode(templateNode_417xrn_a0a0a5a3e);
      }
      Collection<SNode> tlist10 = TemplateUtil.asList(tnode1, tnode4);
      return tlist10;
    }
  }

  public class PatternRule0 implements TemplateReductionRule {
    public PatternRule0() {
    }

    public SNodePointer getRuleNode() {
      return patternRule_417xrn_a0a0f;
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.baseLanguage.structure.ExpressionStatement";
    }

    public Collection<SNode> tryToApply(TemplateExecutionEnvironment environment, TemplateContext context) throws GenerationException {
      return null;
    }
  }

  public class PatternRule1 implements TemplateReductionRule {
    public PatternRule1() {
    }

    public SNodePointer getRuleNode() {
      return patternRule_417xrn_a0a0g;
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.baseLanguage.structure.AndExpression";
    }

    public Collection<SNode> tryToApply(TemplateExecutionEnvironment environment, TemplateContext context) throws GenerationException {
      return null;
    }
  }

  public class PatternRule2 implements TemplateReductionRule {
    public PatternRule2() {
    }

    public SNodePointer getRuleNode() {
      return patternRule_417xrn_a0a0h;
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.baseLanguage.structure.NotExpression";
    }

    public Collection<SNode> tryToApply(TemplateExecutionEnvironment environment, TemplateContext context) throws GenerationException {
      return null;
    }
  }

  public class PatternRule3 implements TemplateReductionRule {
    public PatternRule3() {
    }

    public SNodePointer getRuleNode() {
      return patternRule_417xrn_a0a0i;
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.CustomStatement";
    }

    public Collection<SNode> tryToApply(TemplateExecutionEnvironment environment, TemplateContext context) throws GenerationException {
      return null;
    }
  }

  public class PatternRule4 implements TemplateReductionRule {
    public PatternRule4() {
    }

    public SNodePointer getRuleNode() {
      return patternRule_417xrn_a0a0j;
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.CustomStatementRef";
    }

    public Collection<SNode> tryToApply(TemplateExecutionEnvironment environment, TemplateContext context) throws GenerationException {
      return null;
    }
  }

  public class PatternRule5 implements TemplateReductionRule {
    public PatternRule5() {
    }

    public SNodePointer getRuleNode() {
      return patternRule_417xrn_a0a0k;
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.CustomStatementRef";
    }

    public Collection<SNode> tryToApply(TemplateExecutionEnvironment environment, TemplateContext context) throws GenerationException {
      return null;
    }
  }

  public class PatternRule6 implements TemplateReductionRule {
    public PatternRule6() {
    }

    public SNodePointer getRuleNode() {
      return patternRule_417xrn_a0a0l;
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.CustomStatementRef";
    }

    public Collection<SNode> tryToApply(TemplateExecutionEnvironment environment, TemplateContext context) throws GenerationException {
      return null;
    }
  }

  public class RootMappingRule0 implements TemplateRootMappingRule {
    public RootMappingRule0() {
    }

    public SNodePointer getRuleNode() {
      return rootMappingRule_417xrn_a0a0m;
    }

    public Collection<SNode> apply(final TemplateExecutionEnvironment environment, final TemplateContext context) throws GenerationException {
      return new TemplateRootCustom().apply(environment, context);
    }

    public boolean applyToInheritors() {
      return false;
    }

    public String getApplicableConcept() {
      return "jetbrains.mps.transformation.test.outputLang.structure.CustomRoot";
    }

    public boolean keepSourceRoot() {
      return false;
    }
  }
}
