package jetbrains.mps.project.foreign;

/*Generated by MPS */

import jetbrains.mps.vfs.IFile;

public class ModuleMacroExpander implements MacroExpander {
  private ProjectMacroExpander myProjectMacroExpander;
  private IFile myModuleFile;

  public ModuleMacroExpander(ProjectMacroExpander pme, IFile moduleFile) {
    this.myProjectMacroExpander = pme;
    this.myModuleFile = moduleFile;
  }

  public String expandMacros(String path) {
    if (path == null) {
      return null;
    }
    if (myProjectMacroExpander != null) {
      path = myProjectMacroExpander.expandMacros(path);
    }
    if (myModuleFile != null) {
      // first replace module dir + trailing slash, then just module dir 
      path = path.replaceAll("\\$MODULE_DIR\\$/", myModuleFile.getParent().getPath());
      path = path.replaceAll("\\$MODULE_DIR\\$", myModuleFile.getParent().getPath());
    }
    return path;
  }
}
