package jetbrains.mps.closures.test;

/*Generated by MPS */

import junit.framework.TestCase;
import jetbrains.mps.closures.runtime.FunctionTypes;
import junit.framework.Assert;

public class AdvancedFunctionTypes_Test extends TestCase {

  public void test_returnsFunction() throws Exception {
    FunctionTypes._R<? extends FunctionTypes._R<? extends Integer>> fun1 = new FunctionTypes._R <FunctionTypes._R<Integer>>() {

      public FunctionTypes._R<Integer> invoke() {
        return new FunctionTypes._R <Integer>() {

          public Integer invoke() {
            return 1;
          }

        };
      }

    };
    FunctionTypes._R<? extends FunctionTypes._R<? extends FunctionTypes._R<? extends Integer>>> fun2 = new FunctionTypes._R <FunctionTypes._R<FunctionTypes._R<Integer>>>() {

      public FunctionTypes._R<FunctionTypes._R<Integer>> invoke() {
        return new FunctionTypes._R <FunctionTypes._R<Integer>>() {

          public FunctionTypes._R<Integer> invoke() {
            return new FunctionTypes._R <Integer>() {

              public Integer invoke() {
                return 1;
              }

            };
          }

        };
      }

    };
    FunctionTypes._R<? extends FunctionTypes._R<? extends Integer>> fun3;
    FunctionTypes._R<? extends FunctionTypes._R<? extends Number>> fun4;
    fun1 = fun2.invoke();
    fun3 = fun1;
    fun4 = fun3;
    fun4 = fun2.invoke();
  }

  public void test_acceptsFunction() throws Exception {
    FunctionTypes._R_from_T<? extends Integer, ? extends FunctionTypes._R<? extends Integer>> fun = new FunctionTypes._R_from_T <Integer, FunctionTypes._R<Integer>>() {

      public Integer invoke(FunctionTypes._R<Integer> f) {
        return f.invoke();
      }

    };
    FunctionTypes._R_from_S_and_T<? extends Integer, ? super Integer, ? super Integer> add = new FunctionTypes._R_from_S_and_T <Integer, Integer, Integer>() {

      public Integer invoke(Integer x, Integer y) {
        return x + y;
      }

    };
    FunctionTypes._R_from_T<? extends Integer, ? super Integer> plusThree = new FunctionTypes._R_from_T <Integer, Integer>() {

      public Integer invoke(Integer x) {
        return x + 3;
      }

    };
    FunctionTypes._R_from_T<? extends Integer, ? super Integer> curriedPlusThree = this.curry(add, 3);
    Assert.assertEquals(plusThree.invoke(1), curriedPlusThree.invoke(1));
  }

  public FunctionTypes._R_from_T<? extends Integer, ? super Integer> curry(final FunctionTypes._R_from_S_and_T<? extends Integer, ? super Integer, ? super Integer> fun, final int y) {
    return new FunctionTypes._R_from_T <Integer, Integer>() {

      public Integer invoke(Integer x) {
        return fun.invoke(x, y);
      }

    };
  }

}
