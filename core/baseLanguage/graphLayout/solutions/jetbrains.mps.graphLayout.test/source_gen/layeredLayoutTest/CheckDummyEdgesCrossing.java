package layeredLayoutTest;

/*Generated by MPS */

import jetbrains.mps.graphLayout.layeredLayout.NodeLayeredOrder;
import jetbrains.mps.graphLayout.graph.Graph;
import jetbrains.mps.graphLayout.graph.Node;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.internal.collections.runtime.IWhereFilter;
import jetbrains.mps.internal.collections.runtime.Sequence;
import java.util.List;

public class CheckDummyEdgesCrossing {
  public static boolean hasCrosses(NodeLayeredOrder order) {
    Graph graph = order.getGraph();
    for (int layer = 0; layer < order.getNumLayers() - 1; layer++) {
      Iterable<Node> dummyNodes = ListSequence.fromList(graph.getNodes()).where(new IWhereFilter<Node>() {
        public boolean accept(Node it) {
          return it.isDummy();
        }
      });
      for (int first = 0; first < Sequence.fromIterable(dummyNodes).count(); first++) {
        for (int second = first + 1; second < Sequence.fromIterable(dummyNodes).count(); second++) {
          Node firstTarget = ListSequence.fromList(graph.getNode(first).getOutEdges()).getElement(0).getTarget();
          Node secondTarget = ListSequence.fromList(graph.getNode(second).getOutEdges()).getElement(0).getTarget();
          List<Node> nextLayerOrder = order.getOrder(layer + 1);
          if (ListSequence.fromList(nextLayerOrder).indexOf(firstTarget) > ListSequence.fromList(nextLayerOrder).indexOf(secondTarget)) {
            return true;
          }
        }
      }
    }
    return false;
  }
}
