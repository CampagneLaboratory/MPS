package jetbrains.mps.baseLanguage.unitTest.runtime;

/*Generated by MPS */

import junit.framework.TestListener;
import junit.framework.Test;
import junit.framework.AssertionFailedError;

public class MyTestListener implements TestListener {

  private CommandOutputStream out;
  private CommandOutputStream err;

  public MyTestListener(CommandOutputStream out, CommandOutputStream err) {
    this.out = out;
    this.err = err;
  }

  public void startTest(Test test) {
    this.printSyncToken(TestEvent.START_TEST_PREFIX, test);
  }

  public void addError(Test test, Throwable t) {
    this.printSyncToken(TestEvent.ERROR_TEST_PREFIX, test);
    t.printStackTrace(System.err);
    this.printSyncToken(TestEvent.ERROR_TEST_SUFFIX, test);
  }

  public void addFailure(Test test, AssertionFailedError a) {
    this.printSyncToken(TestEvent.FAILURE_TEST_PREFIX, test);
    a.printStackTrace(System.err);
    this.printSyncToken(TestEvent.FAILURE_TEST_SUFFIX, test);
  }

  public void endTest(Test test) {
    this.printSyncToken(TestEvent.END_TEST_PREFIX, test);
  }

  private void printSyncToken(String tokenPrefix, Test test) {
    TestEvent token = new TestEvent(tokenPrefix, test);
    String out = token.toString();
    this.out.writeCommand(out);
    this.err.writeCommand(out);
  }

}
