package jetbrains.mps.baseLanguage.unitTest.plugin;

/*Generated by MPS */

import javax.swing.event.TreeSelectionListener;
import javax.swing.tree.TreeSelectionModel;
import javax.swing.event.TreeSelectionEvent;
import javax.swing.tree.TreePath;

public class TestTreeSelectionListener implements TreeSelectionListener {
  private TreeSelectionModel treeSelectionModel;
  private TestStatisticsModel statisticsModel;
  private TestOutputComponent outputComponent;

  public TestTreeSelectionListener(TestTree tree, TestStatisticsModel statistics, TestOutputComponent outputComponent) {
    this.treeSelectionModel = tree.getSelectionModel();
    this.statisticsModel = statistics;
    this.outputComponent = outputComponent;
  }

  public void valueChanged(TreeSelectionEvent event) {
    TreePath path = this.treeSelectionModel.getSelectionPath();
    String className = null;
    String methodName = null;
    if (path != null) {
      Object node = path.getLastPathComponent();
      if (node instanceof TestCaseTreeNode) {
        TestCaseTreeNode n = (TestCaseTreeNode)node;
        className = n.getClassName();
      } else if (node instanceof TestMethodTreeNode) {
        TestMethodTreeNode n = (TestMethodTreeNode)node;
        className = n.getClassName();
        methodName = n.getMethodName();
      }
    }
    this.outputComponent.filter(className, methodName);
    this.statisticsModel.setFilter(className, methodName);
  }
}
