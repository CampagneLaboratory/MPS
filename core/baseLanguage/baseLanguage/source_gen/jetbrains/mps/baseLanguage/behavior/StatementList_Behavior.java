package jetbrains.mps.baseLanguage.behavior;

/*Generated by MPS */

import jetbrains.mps.smodel.SNode;
import java.util.List;
import java.util.ArrayList;
import jetbrains.mps.bootstrap.smodelLanguage.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.bootstrap.smodelLanguage.generator.smodelAdapter.SLinkOperations;
import java.util.Set;
import java.util.HashSet;

public class StatementList_Behavior {

  public static void init(SNode thisNode) {
  }

  public static List<SNode> call_getVariablesReferencedInClosures_1213877327584(SNode thisNode) {
    List<SNode> referencedInClosures = new ArrayList<SNode>();
    for(SNode varRef : SNodeOperations.getDescendants(thisNode, "jetbrains.mps.baseLanguage.structure.VariableReference", false)) {
      SNode closure = SNodeOperations.getAncestor(varRef, "jetbrains.mps.baseLanguage.structure.Closure", false, false);
      if ((closure != null) && closure != SNodeOperations.getParent(thisNode)) {
        ListSequence.fromList(referencedInClosures).addElement(SLinkOperations.getTarget(varRef, "variableDeclaration", false));
      }
    }
    return referencedInClosures;
  }

  public static Set<SNode> call_getExternalVariablesDeclarations_1214501165480(SNode thisNode) {
    HashSet<SNode> declarations = new HashSet<SNode>();
    HashSet<SNode> reference = new HashSet<SNode>();
    reference.addAll(SNodeOperations.getDescendants(thisNode, "jetbrains.mps.baseLanguage.structure.LocalVariableReference", false));
    reference.addAll(SNodeOperations.getDescendants(thisNode, "jetbrains.mps.baseLanguage.structure.ParameterReference", false));
    for(SNode ref : reference) {
      boolean statementsContainsVar = false;
      for(SNode parent : SNodeOperations.getAncestors(SLinkOperations.getTarget(ref, "variableDeclaration", false), null, false)) {
        if (parent == SNodeOperations.getParent(thisNode)) {
          statementsContainsVar = true;
        }
      }
      if (!(statementsContainsVar)) {
        declarations.add(SLinkOperations.getTarget(ref, "variableDeclaration", false));
      }
    }
    return declarations;
  }

}
