package jetbrains.mps.baseLanguage.textGen;

/*Generated by MPS */

import java.util.Set;
import jetbrains.mps.util.InternAwareStringSet;
import java.util.List;
import jetbrains.mps.util.InternUtil;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import org.jdom.Element;
import org.jdom.Attribute;
import java.util.HashSet;
import java.util.Collection;

public class RootDependencies implements Comparable<RootDependencies> {
  private static final String CLASS_NAME = "className";
  private static final String FILE_NAME = "file";
  private static final String DEPEND_CLASS = "classNode";
  private static final String DEPEND_CLASS_NAME = "dependClassName";
  private static final String EXTENDS_CLASS_NAME = "extendsClassName";

  private Set<String> myDependNodes = new InternAwareStringSet(0);
  private Set<String> myExtendsNodes = new InternAwareStringSet(0);
  private String myClassName;
  private String myFileName;

  /*package*/ RootDependencies() {
  }

  public RootDependencies(String nodeName, String fileName, List<String> dependNodes, List<String> extendsNodes) {
    this.myClassName = InternUtil.intern(nodeName);
    this.myFileName = InternUtil.intern(fileName);
    if (dependNodes != null) {
      SetSequence.fromSet(this.myDependNodes).addSequence(ListSequence.fromList(dependNodes));
    }
    if (extendsNodes != null) {
      SetSequence.fromSet(this.myExtendsNodes).addSequence(ListSequence.fromList(extendsNodes));
    }
  }

  public RootDependencies(Element element) {
    myClassName = InternUtil.intern(element.getAttribute(CLASS_NAME).getValue());
    Attribute attr = element.getAttribute(FILE_NAME);
    if (attr != null) {
      myFileName = InternUtil.intern(element.getAttribute(CLASS_NAME).getValue());
    }
    for (Element e : ((List<Element>) element.getChildren(DEPEND_CLASS))) {
      if (e == null) {
        continue;
      }
      if (e.getAttribute(DEPEND_CLASS_NAME) != null) {
        String d = e.getAttribute(DEPEND_CLASS_NAME).getValue();
        SetSequence.fromSet(this.myDependNodes).addElement(d);
      }
      if (e.getAttribute(EXTENDS_CLASS_NAME) != null) {
        String ext = e.getAttribute(EXTENDS_CLASS_NAME).getValue();
        SetSequence.fromSet(this.myExtendsNodes).addElement(ext);
      }
    }
  }

  public void saveTo(Element element) {
    element.setAttribute(CLASS_NAME, myClassName);
    if (myClassName != null) {
      element.setAttribute(FILE_NAME, myFileName);
    }
    for (String dependNodeName : this.myDependNodes) {
      Element e = new Element(DEPEND_CLASS);
      e.setAttribute(DEPEND_CLASS_NAME, dependNodeName);
      element.addContent(e);
    }
    for (String dependNodeName : this.myExtendsNodes) {
      Element e = new Element(DEPEND_CLASS);
      e.setAttribute(EXTENDS_CLASS_NAME, dependNodeName);
      element.addContent(e);
    }
  }

  public Set<String> getDependencies() {
    return new HashSet((Collection) myDependNodes);
  }

  public Set<String> getExtends() {
    return new HashSet((Collection) myExtendsNodes);
  }

  /*package*/ void addDependNode(String s) {
    SetSequence.fromSet(myDependNodes).addElement(s);
  }

  /*package*/ void addExtendsNode(String s) {
    SetSequence.fromSet(myExtendsNodes).addElement(s);
  }

  /*package*/ void setFileName(String fileName) {
    this.myFileName = InternUtil.intern(fileName);
  }

  /*package*/ void setClassName(String className) {
    this.myClassName = InternUtil.intern(className);
  }

  public String getClassName() {
    return myClassName;
  }

  public String getFileName() {
    return (myFileName == null ?
      myClassName :
      myFileName
    );
  }

  public int compareTo(RootDependencies p0) {
    if (p0 == null || this.myClassName == null || p0.myClassName == null) {
      return 0;
    }
    return this.myClassName.compareTo(p0.myClassName);
  }
}
