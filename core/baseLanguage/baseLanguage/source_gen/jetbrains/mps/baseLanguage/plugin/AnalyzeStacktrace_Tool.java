package jetbrains.mps.baseLanguage.plugin;

/*Generated by MPS */

import jetbrains.mps.plugins.pluginparts.tool.GeneratedTool;
import com.intellij.execution.impl.ConsoleViewImpl;
import javax.swing.JPanel;
import com.intellij.openapi.project.Project;
import jetbrains.mps.ide.icons.IconManager;
import com.intellij.openapi.wm.ToolWindowAnchor;
import javax.swing.JComponent;
import java.awt.BorderLayout;
import com.intellij.openapi.actionSystem.DefaultActionGroup;
import jetbrains.mps.workbench.tools.CloseAction;
import com.intellij.openapi.actionSystem.ActionManager;
import com.intellij.openapi.actionSystem.ActionPlaces;
import com.intellij.openapi.util.Disposer;
import jetbrains.mps.debug.baseLanguage.StacktraceUtil;
import com.intellij.execution.ui.ConsoleViewContentType;

public class AnalyzeStacktrace_Tool extends GeneratedTool {
  private String myStackTrace;
  private ConsoleViewImpl myConsoleView;
  private JPanel myComponent;

  public AnalyzeStacktrace_Tool(Project project) {
    super(project, "Analyze Stacktrace", -1, IconManager.EMPTY_ICON, ToolWindowAnchor.BOTTOM, false);
  }

  public JComponent getComponent() {
    return AnalyzeStacktrace_Tool.this.myComponent;
  }

  public void init(Project project) {
    AnalyzeStacktrace_Tool.this.myConsoleView = new ConsoleViewImpl(AnalyzeStacktrace_Tool.this.getProject(), false);
    AnalyzeStacktrace_Tool.this.myComponent = new JPanel(new BorderLayout());
    AnalyzeStacktrace_Tool.this.myComponent.add(AnalyzeStacktrace_Tool.this.myConsoleView.getComponent());
    DefaultActionGroup actions = new DefaultActionGroup();
    actions.add(new CloseAction(AnalyzeStacktrace_Tool.this));
    AnalyzeStacktrace_Tool.this.myComponent.add(ActionManager.getInstance().createActionToolbar(ActionPlaces.UNKNOWN, actions, false).getComponent(), BorderLayout.LINE_START);
  }

  public void dispose() {
    Disposer.dispose(AnalyzeStacktrace_Tool.this.myConsoleView);
  }

  public void setStackTrace(String str) {
    AnalyzeStacktrace_Tool.this.myStackTrace = str;
    AnalyzeStacktrace_Tool.this.myConsoleView.clear();
    StacktraceUtil.appendStacktraceToConsole(AnalyzeStacktrace_Tool.this.myConsoleView, str, ConsoleViewContentType.ERROR_OUTPUT);
  }
}
