package jetbrains.mps.baseLanguage.util.plugin.refactorings;

/*Generated by MPS */

import jetbrains.mps.nodeEditor.EditorContext;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.nodeEditor.EditorMessage;

public abstract class DuplicatesProcessor<T> {
  protected EditorContext myEditorContext;

  public DuplicatesProcessor(EditorContext context) {
    this.myEditorContext = context;
  }

  public void process(List<T> duplicates) {
    for (T duplicate : ListSequence.fromList(duplicates)) {
      EditorMessage message = this.createEditorMessage(duplicate);
      this.myEditorContext.getNodeEditorComponent().getHighlightManager().mark(message);
      AskDialog dialog = new AskDialog(this.myEditorContext.getOperationContext().getMainFrame(), "replace this duplicate?");
      dialog.showDialog();
      boolean shouldSubstitute = dialog.getResult();
      this.myEditorContext.getNodeEditorComponent().getHighlightManager().unmark(message);
      if (shouldSubstitute) {
        this.substitute(duplicate);
      }
    }
  }

  public abstract EditorMessage createEditorMessage(T duplicate);

  protected abstract void substitute(T duplicate);
}
