package jetbrains.mps.make.unittest;

/*Generated by MPS */

import junit.framework.TestCase;
import org.jmock.Mockery;
import jetbrains.mps.make.runtime.IFacet;
import junit.framework.Assert;
import jetbrains.mps.make.runtime.internal.FacetRegistry;
import jetbrains.mps.internal.collections.runtime.MapSequence;

public class FacetRegistry_Test extends TestCase {
  private Mockery context;

  public void test_registerUnregister() throws Exception {
    final IFacet fct = Mockups.facet(context, "foobar");
    Assert.assertNotNull(fct);
    FacetRegistry reg = FacetRegistry.getInstance();
    Assert.assertNotNull(reg);
    reg.register(fct);
    Assert.assertSame(fct, MapSequence.fromMap(reg.allFacets()).get(new IFacet.Name("foobar")));
    Assert.assertSame(fct, reg.lookup(new IFacet.Name("foobar")));
    reg.unregister(fct);
    Assert.assertNull(MapSequence.fromMap(reg.allFacets()).get(new IFacet.Name("foobar")));
    Assert.assertNull(reg.lookup(new IFacet.Name("foobar")));
  }

  @Override
  protected void tearDown() throws Exception {
    super.tearDown();
    context.assertIsSatisfied();
  }

  @Override
  protected void setUp() throws Exception {
    super.setUp();
    this.context = new Mockery();
  }
}
