package jetbrains.mps.generator.impl;

/*Generated by MPS */

import jetbrains.mps.components.CoreComponent;
import jetbrains.mps.smodel.GlobalSModelEventsManager;
import jetbrains.mps.smodel.SModelAdapter;
import jetbrains.mps.smodel.event.SModelRootEvent;
import jetbrains.mps.smodel.SNode;
import jetbrains.mps.smodel.SModelStereotype;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.smodel.BootstrapLanguages;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.AttributeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SModelOperations;

public class RootTemplateAnnotator implements CoreComponent {
  public RootTemplateAnnotator(GlobalSModelEventsManager dep) {
  }

  public void init() {
    GlobalSModelEventsManager.getInstance().addGlobalModelListener(new SModelAdapter() {
      public void rootAdded(SModelRootEvent event) {
        SNode node = event.getRoot();
        if (SModelStereotype.isGeneratorModel(SNodeOperations.getModel(node))) {
          if (node.getNodeLanguage() != BootstrapLanguages.generatorLanguage() && node.getNodeLanguage() != BootstrapLanguages.generatorParametersLanguage()) {
            if ((AttributeOperations.getAttribute(node, new IAttributeDescriptor.NodeAttribute(SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.RootTemplateAnnotation"))) == null)) {
              AttributeOperations.setAttribute(node, new IAttributeDescriptor.NodeAttribute(SConceptOperations.findConceptDeclaration("jetbrains.mps.lang.generator.structure.RootTemplateAnnotation")), SModelOperations.createNewNode(SNodeOperations.getModel(node), null, "jetbrains.mps.lang.generator.structure.RootTemplateAnnotation"));
            }
          }
        }
      }
    });
  }

  public void dispose() {
  }
}
