package jetbrains.mps.generator.traceInfo;

/*Generated by MPS */

import java.net.URL;
import jetbrains.mps.project.IModule;
import jetbrains.mps.project.facets.JavaModuleFacet;
import jetbrains.mps.reloading.IClassPathItem;
import jetbrains.mps.project.structure.modules.ModuleDescriptor;
import jetbrains.mps.project.facets.JavaModuleOperations;
import jetbrains.mps.reloading.CommonPaths;

public class JavaTraceInfoResourceProvider implements TraceInfoCache.TraceInfoResourceProvider {
  public JavaTraceInfoResourceProvider() {
  }

  public URL getResource(IModule module, String resourceName) {
    JavaModuleFacet facet = module.getFacet(JavaModuleFacet.class);
    if (facet == null) {
      return null;
    }

    IClassPathItem classPathItem;
    ModuleDescriptor descriptor = module.getModuleDescriptor();
    if (facet.isCompileInMPS() || descriptor != null && !(descriptor.getAdditionalJavaStubPaths().isEmpty())) {
      classPathItem = JavaModuleOperations.createClassPathItem(facet.getClassPath(), JavaTraceInfoResourceProvider.class.getName());
    } else {
      // todo: looks wrong. just go to classes gen in this case too 
      classPathItem = CommonPaths.getMPSClassPath();
    }
    if (classPathItem == null) {
      return null;
    }
    return classPathItem.getResource(resourceName);
  }
}
