package jetbrains.mps.generator.traceInfo;

/*Generated by MPS */

import org.jetbrains.annotations.Nullable;
import java.net.URL;
import jetbrains.mps.project.IModule;
import jetbrains.mps.vfs.IFile;
import jetbrains.mps.vfs.FileSystem;
import java.io.File;
import java.net.MalformedURLException;
import jetbrains.mps.MPSCore;

public class TraceInfoFromSourceProvider implements TraceInfoCache.TraceInfoResourceProvider {
  public TraceInfoFromSourceProvider() {
  }

  @Nullable
  public URL getResource(IModule module, String resourceName) {
    if (!(TraceInfoFromSourceProvider.isInAnt())) {
      return null;
    }
    String generatorOutputPath = module.getGeneratorOutputPath();
    if ((generatorOutputPath == null || generatorOutputPath.length() == 0)) {
      return null;
    }
    IFile traceInfoFile = FileSystem.getInstance().getFileByPath(generatorOutputPath).getDescendant(resourceName);
    if (!(traceInfoFile.exists())) {
      return null;
    }
    URL url = null;
    try {
      url = new File(traceInfoFile.getPath().replace("/", File.separator)).toURI().toURL();
    } catch (MalformedURLException e) {
    }
    return url;
  }

  public static boolean isInAnt() {
    return MPSCore.getInstance().isTestMode();
  }
}
